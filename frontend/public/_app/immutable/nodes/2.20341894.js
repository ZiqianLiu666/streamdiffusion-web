import{f as Gt,s as he,c as Yt,u as Qt,g as Kt,d as Zt,h as en,n as le,e as Ie,i as Mt,b as de,j as He,r as it,o as Fe,k as Ot,l as Se}from"../chunks/scheduler.89a8ecb7.js";import{S as ge,i as _e,g as L,h as R,j as $,f as b,k as p,a as O,y as ue,d as A,t as G,z as Ue,A as ze,x as P,p as me,b as pe,s as U,m as se,r as ee,c as z,B as fe,n as oe,u as te,l as we,v as ne,o as Le,w as ae,C as Ke,D as et,E as ye,F as Nt,G as Qe,e as be,H as ke,I as tn,J as nn,K as an}from"../chunks/index.4ad94557.js";import{w as Me,d as rn}from"../chunks/index.ca9f7e73.js";const ln=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function xe(n){return(n==null?void 0:n.length)!==void 0?n:Array.from(n)}const sn=!0,Ea=Object.freeze(Object.defineProperty({__proto__:null,prerender:sn},Symbol.toStringTag,{value:"Module"}));var Ee=(n=>(n.RANGE="range",n.SEED="seed",n.TEXTAREA="textarea",n.CHECKBOX="checkbox",n.SELECT="select",n))(Ee||{}),Bt=(n=>(n.IMAGE="image",n.VIDEO="video",n.TEXT="text",n))(Bt||{}),Ze=(n=>(n.CONNECTED="connected",n.DISCONNECTED="disconnected",n.WAIT="wait",n.SEND_FRAME="send_frame",n.TIMEOUT="timeout",n))(Ze||{});const on="disconnected",Ae=Me(on),Ne=Me(null);let Pe=null;const tt={async start(n){return new Promise((e,t)=>{try{const i=crypto.randomUUID(),l=`${window.location.protocol==="https:"?"wss":"ws"}:${window.location.host}/api/ws/${i}`;Pe=new WebSocket(l),Pe.onopen=()=>{window.globalWs=Pe,console.log("Connected to websocket")},Pe.onclose=()=>{Ae.set("disconnected"),console.log("Disconnected from websocket")},Pe.onerror=s=>{console.error(s)},Pe.onmessage=s=>{const a=JSON.parse(s.data);switch(a.status){case"connected":Ae.set("connected"),Ne.set(i),e({status:"connected",userId:i});break;case"send_frame":Ae.set("send_frame");const o=n();Pe==null||Pe.send(JSON.stringify({status:"next_frame"}));for(const r of o)this.send(r);break;case"wait":Ae.set("wait");break;case"timeout":console.log("timeout"),Ae.set("timeout"),Ne.set(null),t(new Error("timeout"));break;case"error":console.log(a.message),Ae.set("disconnected"),Ne.set(null),t(new Error(a.message));break}}}catch(i){console.error(i),Ae.set("disconnected"),Ne.set(null),t(i)}})},send(n){const e=window.globalWs;e&&e.readyState===WebSocket.OPEN?n instanceof Blob?e.send(n):e.send(JSON.stringify(n)):console.warn("⚠️ WebSocket not connected")},async stop(){Ae.set("disconnected"),Pe&&Pe.close(),Pe=null,Ne.set(null)}},ce=Me({}),cn=rn(ce,(n,e)=>{const t=setTimeout(()=>{e(n)},100);return()=>clearTimeout(t)}),Ve=()=>Gt(ce);function un(n){let e,t,i,l,s;const a=n[4].default,o=Yt(a,n,n[3],null);return{c(){e=L("button"),o&&o.c(),this.h()},l(r){e=R(r,"BUTTON",{class:!0,title:!0});var c=$(e);o&&o.l(c),c.forEach(b),this.h()},h(){p(e,"class",t="button "+n[0]+" svelte-1eet948"),e.disabled=n[1],p(e,"title",n[2])},m(r,c){O(r,e,c),o&&o.m(e,null),i=!0,l||(s=ue(e,"click",n[5]),l=!0)},p(r,[c]){o&&o.p&&(!i||c&8)&&Qt(o,a,r,r[3],i?Zt(a,r[3],c,null):Kt(r[3]),null),(!i||c&1&&t!==(t="button "+r[0]+" svelte-1eet948"))&&p(e,"class",t),(!i||c&2)&&(e.disabled=r[1]),(!i||c&4)&&p(e,"title",r[2])},i(r){i||(A(o,r),i=!0)},o(r){G(o,r),i=!1},d(r){r&&b(e),o&&o.d(r),l=!1,s()}}}function fn(n,e,t){let{$$slots:i={},$$scope:l}=e,{classList:s="p-2"}=e,{disabled:a=!1}=e,{title:o=""}=e;function r(c){en.call(this,n,c)}return n.$$set=c=>{"classList"in c&&t(0,s=c.classList),"disabled"in c&&t(1,a=c.disabled),"title"in c&&t(2,o=c.title),"$$scope"in c&&t(3,l=c.$$scope)},[s,a,o,l,i,r]}class Ge extends ge{constructor(e){super(),_e(this,e,fn,un,he,{classList:0,disabled:1,title:2})}}function dn(n){let e,t;return{c(){e=Ue("svg"),t=Ue("path"),this.h()},l(i){e=ze(i,"svg",{xmlns:!0,height:!0,viewBox:!0,class:!0});var l=$(e);t=ze(l,"path",{fill:!0,d:!0}),$(t).forEach(b),l.forEach(b),this.h()},h(){p(t,"fill","currentColor"),p(t,"d","M48 96v320a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16V170.5a16 16 0 0 0-4.7-11.3l33.9-33.9a64 64 0 0 1 18.7 45.3V416a64 64 0 0 1-64 64H64a64 64 0 0 1-64-64V96a64 64 0 0 1 64-64h245.5a64 64 0 0 1 45.3 18.7l74.5 74.5-33.9 33.9-74.6-74.4-.8-.8V184a24 24 0 0 1-24 24H104a24 24 0 0 1-24-24V80H64a16 16 0 0 0-16 16zm80-16v80h144V80H128zm32 240a64 64 0 1 1 128 0 64 64 0 1 1-128 0z"),p(e,"xmlns","http://www.w3.org/2000/svg"),p(e,"height","1em"),p(e,"viewBox","0 0 448 512"),p(e,"class",n[0])},m(i,l){O(i,e,l),P(e,t)},p(i,[l]){l&1&&p(e,"class",i[0])},i:le,o:le,d(i){i&&b(e)}}}function mn(n,e,t){let{classList:i}=e;return n.$$set=l=>{"classList"in l&&t(0,i=l.classList)},[i]}class pn extends ge{constructor(e){super(),_e(this,e,mn,dn,he,{classList:0})}}var at={exports:{}};(function(n,e){(function(){var t={};t.version="1.0.4",t.remove=function(u){var f=!1;if(u.slice(0,2)!="ÿØ")if(u.slice(0,23)=="data:image/jpeg;base64,"||u.slice(0,22)=="data:image/jpg;base64,")u=_(u.split(",")[1]),f=!0;else throw new Error("Given data is not jpeg.");var m=T(u),g=m.filter(function(h){return!(h.slice(0,2)=="ÿá"&&h.slice(4,10)=="Exif\0\0")}),y=g.join("");return f&&(y="data:image/jpeg;base64,"+v(y)),y},t.insert=function(u,f){var m=!1;if(u.slice(0,6)!="Exif\0\0")throw new Error("Given data is not exif.");if(f.slice(0,2)!="ÿØ")if(f.slice(0,23)=="data:image/jpeg;base64,"||f.slice(0,22)=="data:image/jpg;base64,")f=_(f.split(",")[1]),m=!0;else throw new Error("Given data is not jpeg.");var g="ÿá"+d(">H",[u.length+2])+u,y=T(f),h=C(y,g);return m&&(h="data:image/jpeg;base64,"+v(h)),h},t.load=function(u){var f;if(typeof u=="string")if(u.slice(0,2)=="ÿØ")f=u;else if(u.slice(0,23)=="data:image/jpeg;base64,"||u.slice(0,22)=="data:image/jpg;base64,")f=_(u.split(",")[1]);else if(u.slice(0,4)=="Exif")f=u.slice(6);else throw new Error("'load' gots invalid file data.");else throw new Error("'load' gots invalid type argument.");var m={"0th":{},Exif:{},GPS:{},Interop:{},"1st":{},thumbnail:null},g=new k(f);if(g.tiftag===null)return m;g.tiftag.slice(0,2)=="II"?g.endian_mark="<":g.endian_mark=">";var y=S(g.endian_mark+"L",g.tiftag.slice(4,8))[0];m["0th"]=g.get_ifd(y,"0th");var h=m["0th"].first_ifd_pointer;if(delete m["0th"].first_ifd_pointer,34665 in m["0th"]&&(y=m["0th"][34665],m.Exif=g.get_ifd(y,"Exif")),34853 in m["0th"]&&(y=m["0th"][34853],m.GPS=g.get_ifd(y,"GPS")),40965 in m.Exif&&(y=m.Exif[40965],m.Interop=g.get_ifd(y,"Interop")),h!="\0\0\0\0"&&(y=S(g.endian_mark+"L",h)[0],m["1st"]=g.get_ifd(y,"1st"),513 in m["1st"]&&514 in m["1st"])){var D=m["1st"][513]+m["1st"][514],N=g.tiftag.slice(m["1st"][513],D);m.thumbnail=N}return m},t.dump=function(u){var f=8,m=i(u),g="Exif\0\0MM\0*\0\0\0\b",y=!1,h=!1,D=!1,N=!1,B,M,q,W,Z;"0th"in m?B=m["0th"]:B={},"Exif"in m&&Object.keys(m.Exif).length||"Interop"in m&&Object.keys(m.Interop).length?(B[34665]=1,y=!0,M=m.Exif,"Interop"in m&&Object.keys(m.Interop).length?(M[40965]=1,D=!0,q=m.Interop):Object.keys(M).indexOf(t.ExifIFD.InteroperabilityTag.toString())>-1&&delete M[40965]):Object.keys(B).indexOf(t.ImageIFD.ExifTag.toString())>-1&&delete B[34665],"GPS"in m&&Object.keys(m.GPS).length?(B[t.ImageIFD.GPSTag]=1,h=!0,W=m.GPS):Object.keys(B).indexOf(t.ImageIFD.GPSTag.toString())>-1&&delete B[t.ImageIFD.GPSTag],"1st"in m&&"thumbnail"in m&&m.thumbnail!=null&&(N=!0,m["1st"][513]=1,m["1st"][514]=1,Z=m["1st"]);var re=c(B,"0th",0),J=re[0].length+y*12+h*12+4+re[1].length,Q,F="",X=0,Y,j="",K=0,V,H="",ve=0,ie,Re="",Ce;if(y&&(Q=c(M,"Exif",J),X=Q[0].length+D*12+Q[1].length),h&&(Y=c(W,"GPS",J+X),j=Y.join(""),K=j.length),D){var De=J+X+K;V=c(q,"Interop",De),H=V.join(""),ve=H.length}if(N){var De=J+X+K+ve;if(ie=c(Z,"1st",De),Ce=l(m.thumbnail),Ce.length>64e3)throw new Error("Given thumbnail is too large. max 64kB")}var ot="",ct="",ut="",ft="\0\0\0\0";if(y){var Te=f+J,je=d(">L",[Te]),qe=34665,We=d(">H",[qe]),Xe=d(">H",[x.Long]),Je=d(">L",[1]);ot=We+Xe+Je+je}if(h){var Te=f+J+X,je=d(">L",[Te]),qe=34853,We=d(">H",[qe]),Xe=d(">H",[x.Long]),Je=d(">L",[1]);ct=We+Xe+Je+je}if(D){var Te=f+J+X+K,je=d(">L",[Te]),qe=40965,We=d(">H",[qe]),Xe=d(">H",[x.Long]),Je=d(">L",[1]);ut=We+Xe+Je+je}if(N){var Te=f+J+X+K+ve;ft=d(">L",[Te]);var qt=Te+ie[0].length+24+4+ie[1].length,Wt="\0\0\0\0"+d(">L",[qt]),Xt="\0\0\0\0"+d(">L",[Ce.length]);Re=ie[0]+Wt+Xt+"\0\0\0\0"+ie[1]+Ce}var Jt=re[0]+ot+ct+ft+re[1];return y&&(F=Q[0]+ut+Q[1]),g+Jt+F+j+H+Re};function i(u){return JSON.parse(JSON.stringify(u))}function l(u){for(var f=T(u);"ÿà"<=f[1].slice(0,2)&&f[1].slice(0,2)<="ÿï";)f=[f[0]].concat(f.slice(2));return f.join("")}function s(u){return d(">"+E("B",u.length),u)}function a(u){return d(">"+E("H",u.length),u)}function o(u){return d(">"+E("L",u.length),u)}function r(u,f,m){var g="",y="",h,D,N,B;if(f=="Byte")h=u.length,h<=4?y=s(u)+E("\0",4-h):(y=d(">L",[m]),g=s(u));else if(f=="Short")h=u.length,h<=2?y=a(u)+E("\0\0",2-h):(y=d(">L",[m]),g=a(u));else if(f=="Long")h=u.length,h<=1?y=o(u):(y=d(">L",[m]),g=o(u));else if(f=="Ascii")D=u+"\0",h=D.length,h>4?(y=d(">L",[m]),g=D):y=D+E("\0",4-h);else if(f=="Rational"){if(typeof u[0]=="number")h=1,N=u[0],B=u[1],D=d(">L",[N])+d(">L",[B]);else{h=u.length,D="";for(var M=0;M<h;M++)N=u[M][0],B=u[M][1],D+=d(">L",[N])+d(">L",[B])}y=d(">L",[m]),g=D}else if(f=="SRational"){if(typeof u[0]=="number")h=1,N=u[0],B=u[1],D=d(">l",[N])+d(">l",[B]);else{h=u.length,D="";for(var M=0;M<h;M++)N=u[M][0],B=u[M][1],D+=d(">l",[N])+d(">l",[B])}y=d(">L",[m]),g=D}else f=="Undefined"&&(h=u.length,h>4?(y=d(">L",[m]),g=u):y=u+E("\0",4-h));var q=d(">L",[h]);return[q,y,g]}function c(u,f,m){var g=8,y=Object.keys(u).length,h=d(">H",[y]),D;["0th","1st"].indexOf(f)>-1?D=2+y*12+4:D=2+y*12;var N="",B="",M;for(var M in u)if(typeof M=="string"&&(M=parseInt(M)),!(f=="0th"&&[34665,34853].indexOf(M)>-1)){{if(f=="Exif"&&M==40965)continue;if(f=="1st"&&[513,514].indexOf(M)>-1)continue}var q=u[M],W=d(">H",[M]),Z=I[f][M].type,re=d(">H",[x[Z]]);typeof q=="number"&&(q=[q]);var J=g+D+m+B.length,Q=r(q,Z,J),F=Q[0],X=Q[1],Y=Q[2];N+=W+re+F+X,B+=Y}return[h+N,B]}function k(u){var f,m;if(u.slice(0,2)=="ÿØ")f=T(u),m=w(f),m?this.tiftag=m.slice(10):this.tiftag=null;else if(["II","MM"].indexOf(u.slice(0,2))>-1)this.tiftag=u;else if(u.slice(0,4)=="Exif")this.tiftag=u.slice(6);else throw new Error("Given file is neither JPEG nor TIFF.")}if(k.prototype={get_ifd:function(u,f){var m={},g=S(this.endian_mark+"H",this.tiftag.slice(u,u+2))[0],y=u+2,h;["0th","1st"].indexOf(f)>-1?h="Image":h=f;for(var D=0;D<g;D++){u=y+12*D;var N=S(this.endian_mark+"H",this.tiftag.slice(u,u+2))[0],B=S(this.endian_mark+"H",this.tiftag.slice(u+2,u+4))[0],M=S(this.endian_mark+"L",this.tiftag.slice(u+4,u+8))[0],q=this.tiftag.slice(u+8,u+12),W=[B,M,q];N in I[h]&&(m[N]=this.convert_value(W))}return f=="0th"&&(u=y+12*g,m.first_ifd_pointer=this.tiftag.slice(u,u+4)),m},convert_value:function(u){var f=null,m=u[0],g=u[1],y=u[2],h;if(m==1)g>4?(h=S(this.endian_mark+"L",y)[0],f=S(this.endian_mark+E("B",g),this.tiftag.slice(h,h+g))):f=S(this.endian_mark+E("B",g),y.slice(0,g));else if(m==2)g>4?(h=S(this.endian_mark+"L",y)[0],f=this.tiftag.slice(h,h+g-1)):f=y.slice(0,g-1);else if(m==3)g>2?(h=S(this.endian_mark+"L",y)[0],f=S(this.endian_mark+E("H",g),this.tiftag.slice(h,h+g*2))):f=S(this.endian_mark+E("H",g),y.slice(0,g*2));else if(m==4)g>1?(h=S(this.endian_mark+"L",y)[0],f=S(this.endian_mark+E("L",g),this.tiftag.slice(h,h+g*4))):f=S(this.endian_mark+E("L",g),y);else if(m==5)if(h=S(this.endian_mark+"L",y)[0],g>1){f=[];for(var D=0;D<g;D++)f.push([S(this.endian_mark+"L",this.tiftag.slice(h+D*8,h+4+D*8))[0],S(this.endian_mark+"L",this.tiftag.slice(h+4+D*8,h+8+D*8))[0]])}else f=[S(this.endian_mark+"L",this.tiftag.slice(h,h+4))[0],S(this.endian_mark+"L",this.tiftag.slice(h+4,h+8))[0]];else if(m==7)g>4?(h=S(this.endian_mark+"L",y)[0],f=this.tiftag.slice(h,h+g)):f=y.slice(0,g);else if(m==9)g>1?(h=S(this.endian_mark+"L",y)[0],f=S(this.endian_mark+E("l",g),this.tiftag.slice(h,h+g*4))):f=S(this.endian_mark+E("l",g),y);else if(m==10)if(h=S(this.endian_mark+"L",y)[0],g>1){f=[];for(var D=0;D<g;D++)f.push([S(this.endian_mark+"l",this.tiftag.slice(h+D*8,h+4+D*8))[0],S(this.endian_mark+"l",this.tiftag.slice(h+4+D*8,h+8+D*8))[0]])}else f=[S(this.endian_mark+"l",this.tiftag.slice(h,h+4))[0],S(this.endian_mark+"l",this.tiftag.slice(h+4,h+8))[0]];else throw new Error("Exif might be wrong. Got incorrect value type to decode. type:"+m);return f instanceof Array&&f.length==1?f[0]:f}},typeof window<"u"&&typeof window.btoa=="function")var v=window.btoa;if(typeof v>"u")var v=function(f){for(var m="",g,y,h,D,N,B,M,q=0,W="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";q<f.length;)g=f.charCodeAt(q++),y=f.charCodeAt(q++),h=f.charCodeAt(q++),D=g>>2,N=(g&3)<<4|y>>4,B=(y&15)<<2|h>>6,M=h&63,isNaN(y)?B=M=64:isNaN(h)&&(M=64),m=m+W.charAt(D)+W.charAt(N)+W.charAt(B)+W.charAt(M);return m};if(typeof window<"u"&&typeof window.atob=="function")var _=window.atob;if(typeof _>"u")var _=function(f){var m="",g,y,h,D,N,B,M,q=0,W="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";for(f=f.replace(/[^A-Za-z0-9\+\/\=]/g,"");q<f.length;)D=W.indexOf(f.charAt(q++)),N=W.indexOf(f.charAt(q++)),B=W.indexOf(f.charAt(q++)),M=W.indexOf(f.charAt(q++)),g=D<<2|N>>4,y=(N&15)<<4|B>>2,h=(B&3)<<6|M,m=m+String.fromCharCode(g),B!=64&&(m=m+String.fromCharCode(y)),M!=64&&(m=m+String.fromCharCode(h));return m};function d(u,f){if(!(f instanceof Array))throw new Error("'pack' error. Got invalid type argument.");if(u.length-1!=f.length)throw new Error("'pack' error. "+(u.length-1)+" marks, "+f.length+" elements.");var m;if(u[0]=="<")m=!0;else if(u[0]==">")m=!1;else throw new Error("");for(var g="",y=1,h=null,D=null,N=null;D=u[y];){if(D.toLowerCase()=="b"){if(h=f[y-1],D=="b"&&h<0&&(h+=256),h>255||h<0)throw new Error("'pack' error.");N=String.fromCharCode(h)}else if(D=="H"){if(h=f[y-1],h>65535||h<0)throw new Error("'pack' error.");N=String.fromCharCode(Math.floor(h%65536/256))+String.fromCharCode(h%256),m&&(N=N.split("").reverse().join(""))}else if(D.toLowerCase()=="l"){if(h=f[y-1],D=="l"&&h<0&&(h+=4294967296),h>4294967295||h<0)throw new Error("'pack' error.");N=String.fromCharCode(Math.floor(h/16777216))+String.fromCharCode(Math.floor(h%16777216/65536))+String.fromCharCode(Math.floor(h%65536/256))+String.fromCharCode(h%256),m&&(N=N.split("").reverse().join(""))}else throw new Error("'pack' error.");g+=N,y+=1}return g}function S(u,f){if(typeof f!="string")throw new Error("'unpack' error. Got invalid type argument.");for(var m=0,g=1;g<u.length;g++)if(u[g].toLowerCase()=="b")m+=1;else if(u[g].toLowerCase()=="h")m+=2;else if(u[g].toLowerCase()=="l")m+=4;else throw new Error("'unpack' error. Got invalid mark.");if(m!=f.length)throw new Error("'unpack' error. Mismatch between symbol and string length. "+m+":"+f.length);var y;if(u[0]=="<")y=!0;else if(u[0]==">")y=!1;else throw new Error("'unpack' error.");for(var h=[],D=0,N=1,B=null,M=null,q=null,W="";M=u[N];){if(M.toLowerCase()=="b")q=1,W=f.slice(D,D+q),B=W.charCodeAt(0),M=="b"&&B>=128&&(B-=256);else if(M=="H")q=2,W=f.slice(D,D+q),y&&(W=W.split("").reverse().join("")),B=W.charCodeAt(0)*256+W.charCodeAt(1);else if(M.toLowerCase()=="l")q=4,W=f.slice(D,D+q),y&&(W=W.split("").reverse().join("")),B=W.charCodeAt(0)*16777216+W.charCodeAt(1)*65536+W.charCodeAt(2)*256+W.charCodeAt(3),M=="l"&&B>=2147483648&&(B-=4294967296);else throw new Error("'unpack' error. "+M);h.push(B),D+=q,N+=1}return h}function E(u,f){for(var m="",g=0;g<f;g++)m+=u;return m}function T(u){if(u.slice(0,2)!="ÿØ")throw new Error("Given data isn't JPEG.");for(var f=2,m=["ÿØ"];;){if(u.slice(f,f+2)=="ÿÚ"){m.push(u.slice(f));break}else{var g=S(">H",u.slice(f+2,f+4))[0],y=f+g+2;m.push(u.slice(f,y)),f=y}if(f>=u.length)throw new Error("Wrong JPEG data.")}return m}function w(u){for(var f,m=0;m<u.length;m++)if(f=u[m],f.slice(0,2)=="ÿá"&&f.slice(4,10)=="Exif\0\0")return f;return null}function C(u,f){var m=!1,g=[];return u.forEach(function(y,h){y.slice(0,2)=="ÿá"&&y.slice(4,10)=="Exif\0\0"&&(m?g.unshift(h):(u[h]=f,m=!0))}),g.forEach(function(y){u.splice(y,1)}),!m&&f&&(u=[u[0],f].concat(u.slice(1))),u.join("")}var x={Byte:1,Ascii:2,Short:3,Long:4,Rational:5,Undefined:7,SLong:9,SRational:10},I={Image:{11:{name:"ProcessingSoftware",type:"Ascii"},254:{name:"NewSubfileType",type:"Long"},255:{name:"SubfileType",type:"Short"},256:{name:"ImageWidth",type:"Long"},257:{name:"ImageLength",type:"Long"},258:{name:"BitsPerSample",type:"Short"},259:{name:"Compression",type:"Short"},262:{name:"PhotometricInterpretation",type:"Short"},263:{name:"Threshholding",type:"Short"},264:{name:"CellWidth",type:"Short"},265:{name:"CellLength",type:"Short"},266:{name:"FillOrder",type:"Short"},269:{name:"DocumentName",type:"Ascii"},270:{name:"ImageDescription",type:"Ascii"},271:{name:"Make",type:"Ascii"},272:{name:"Model",type:"Ascii"},273:{name:"StripOffsets",type:"Long"},274:{name:"Orientation",type:"Short"},277:{name:"SamplesPerPixel",type:"Short"},278:{name:"RowsPerStrip",type:"Long"},279:{name:"StripByteCounts",type:"Long"},282:{name:"XResolution",type:"Rational"},283:{name:"YResolution",type:"Rational"},284:{name:"PlanarConfiguration",type:"Short"},290:{name:"GrayResponseUnit",type:"Short"},291:{name:"GrayResponseCurve",type:"Short"},292:{name:"T4Options",type:"Long"},293:{name:"T6Options",type:"Long"},296:{name:"ResolutionUnit",type:"Short"},301:{name:"TransferFunction",type:"Short"},305:{name:"Software",type:"Ascii"},306:{name:"DateTime",type:"Ascii"},315:{name:"Artist",type:"Ascii"},316:{name:"HostComputer",type:"Ascii"},317:{name:"Predictor",type:"Short"},318:{name:"WhitePoint",type:"Rational"},319:{name:"PrimaryChromaticities",type:"Rational"},320:{name:"ColorMap",type:"Short"},321:{name:"HalftoneHints",type:"Short"},322:{name:"TileWidth",type:"Short"},323:{name:"TileLength",type:"Short"},324:{name:"TileOffsets",type:"Short"},325:{name:"TileByteCounts",type:"Short"},330:{name:"SubIFDs",type:"Long"},332:{name:"InkSet",type:"Short"},333:{name:"InkNames",type:"Ascii"},334:{name:"NumberOfInks",type:"Short"},336:{name:"DotRange",type:"Byte"},337:{name:"TargetPrinter",type:"Ascii"},338:{name:"ExtraSamples",type:"Short"},339:{name:"SampleFormat",type:"Short"},340:{name:"SMinSampleValue",type:"Short"},341:{name:"SMaxSampleValue",type:"Short"},342:{name:"TransferRange",type:"Short"},343:{name:"ClipPath",type:"Byte"},344:{name:"XClipPathUnits",type:"Long"},345:{name:"YClipPathUnits",type:"Long"},346:{name:"Indexed",type:"Short"},347:{name:"JPEGTables",type:"Undefined"},351:{name:"OPIProxy",type:"Short"},512:{name:"JPEGProc",type:"Long"},513:{name:"JPEGInterchangeFormat",type:"Long"},514:{name:"JPEGInterchangeFormatLength",type:"Long"},515:{name:"JPEGRestartInterval",type:"Short"},517:{name:"JPEGLosslessPredictors",type:"Short"},518:{name:"JPEGPointTransforms",type:"Short"},519:{name:"JPEGQTables",type:"Long"},520:{name:"JPEGDCTables",type:"Long"},521:{name:"JPEGACTables",type:"Long"},529:{name:"YCbCrCoefficients",type:"Rational"},530:{name:"YCbCrSubSampling",type:"Short"},531:{name:"YCbCrPositioning",type:"Short"},532:{name:"ReferenceBlackWhite",type:"Rational"},700:{name:"XMLPacket",type:"Byte"},18246:{name:"Rating",type:"Short"},18249:{name:"RatingPercent",type:"Short"},32781:{name:"ImageID",type:"Ascii"},33421:{name:"CFARepeatPatternDim",type:"Short"},33422:{name:"CFAPattern",type:"Byte"},33423:{name:"BatteryLevel",type:"Rational"},33432:{name:"Copyright",type:"Ascii"},33434:{name:"ExposureTime",type:"Rational"},34377:{name:"ImageResources",type:"Byte"},34665:{name:"ExifTag",type:"Long"},34675:{name:"InterColorProfile",type:"Undefined"},34853:{name:"GPSTag",type:"Long"},34857:{name:"Interlace",type:"Short"},34858:{name:"TimeZoneOffset",type:"Long"},34859:{name:"SelfTimerMode",type:"Short"},37387:{name:"FlashEnergy",type:"Rational"},37388:{name:"SpatialFrequencyResponse",type:"Undefined"},37389:{name:"Noise",type:"Undefined"},37390:{name:"FocalPlaneXResolution",type:"Rational"},37391:{name:"FocalPlaneYResolution",type:"Rational"},37392:{name:"FocalPlaneResolutionUnit",type:"Short"},37393:{name:"ImageNumber",type:"Long"},37394:{name:"SecurityClassification",type:"Ascii"},37395:{name:"ImageHistory",type:"Ascii"},37397:{name:"ExposureIndex",type:"Rational"},37398:{name:"TIFFEPStandardID",type:"Byte"},37399:{name:"SensingMethod",type:"Short"},40091:{name:"XPTitle",type:"Byte"},40092:{name:"XPComment",type:"Byte"},40093:{name:"XPAuthor",type:"Byte"},40094:{name:"XPKeywords",type:"Byte"},40095:{name:"XPSubject",type:"Byte"},50341:{name:"PrintImageMatching",type:"Undefined"},50706:{name:"DNGVersion",type:"Byte"},50707:{name:"DNGBackwardVersion",type:"Byte"},50708:{name:"UniqueCameraModel",type:"Ascii"},50709:{name:"LocalizedCameraModel",type:"Byte"},50710:{name:"CFAPlaneColor",type:"Byte"},50711:{name:"CFALayout",type:"Short"},50712:{name:"LinearizationTable",type:"Short"},50713:{name:"BlackLevelRepeatDim",type:"Short"},50714:{name:"BlackLevel",type:"Rational"},50715:{name:"BlackLevelDeltaH",type:"SRational"},50716:{name:"BlackLevelDeltaV",type:"SRational"},50717:{name:"WhiteLevel",type:"Short"},50718:{name:"DefaultScale",type:"Rational"},50719:{name:"DefaultCropOrigin",type:"Short"},50720:{name:"DefaultCropSize",type:"Short"},50721:{name:"ColorMatrix1",type:"SRational"},50722:{name:"ColorMatrix2",type:"SRational"},50723:{name:"CameraCalibration1",type:"SRational"},50724:{name:"CameraCalibration2",type:"SRational"},50725:{name:"ReductionMatrix1",type:"SRational"},50726:{name:"ReductionMatrix2",type:"SRational"},50727:{name:"AnalogBalance",type:"Rational"},50728:{name:"AsShotNeutral",type:"Short"},50729:{name:"AsShotWhiteXY",type:"Rational"},50730:{name:"BaselineExposure",type:"SRational"},50731:{name:"BaselineNoise",type:"Rational"},50732:{name:"BaselineSharpness",type:"Rational"},50733:{name:"BayerGreenSplit",type:"Long"},50734:{name:"LinearResponseLimit",type:"Rational"},50735:{name:"CameraSerialNumber",type:"Ascii"},50736:{name:"LensInfo",type:"Rational"},50737:{name:"ChromaBlurRadius",type:"Rational"},50738:{name:"AntiAliasStrength",type:"Rational"},50739:{name:"ShadowScale",type:"SRational"},50740:{name:"DNGPrivateData",type:"Byte"},50741:{name:"MakerNoteSafety",type:"Short"},50778:{name:"CalibrationIlluminant1",type:"Short"},50779:{name:"CalibrationIlluminant2",type:"Short"},50780:{name:"BestQualityScale",type:"Rational"},50781:{name:"RawDataUniqueID",type:"Byte"},50827:{name:"OriginalRawFileName",type:"Byte"},50828:{name:"OriginalRawFileData",type:"Undefined"},50829:{name:"ActiveArea",type:"Short"},50830:{name:"MaskedAreas",type:"Short"},50831:{name:"AsShotICCProfile",type:"Undefined"},50832:{name:"AsShotPreProfileMatrix",type:"SRational"},50833:{name:"CurrentICCProfile",type:"Undefined"},50834:{name:"CurrentPreProfileMatrix",type:"SRational"},50879:{name:"ColorimetricReference",type:"Short"},50931:{name:"CameraCalibrationSignature",type:"Byte"},50932:{name:"ProfileCalibrationSignature",type:"Byte"},50934:{name:"AsShotProfileName",type:"Byte"},50935:{name:"NoiseReductionApplied",type:"Rational"},50936:{name:"ProfileName",type:"Byte"},50937:{name:"ProfileHueSatMapDims",type:"Long"},50938:{name:"ProfileHueSatMapData1",type:"Float"},50939:{name:"ProfileHueSatMapData2",type:"Float"},50940:{name:"ProfileToneCurve",type:"Float"},50941:{name:"ProfileEmbedPolicy",type:"Long"},50942:{name:"ProfileCopyright",type:"Byte"},50964:{name:"ForwardMatrix1",type:"SRational"},50965:{name:"ForwardMatrix2",type:"SRational"},50966:{name:"PreviewApplicationName",type:"Byte"},50967:{name:"PreviewApplicationVersion",type:"Byte"},50968:{name:"PreviewSettingsName",type:"Byte"},50969:{name:"PreviewSettingsDigest",type:"Byte"},50970:{name:"PreviewColorSpace",type:"Long"},50971:{name:"PreviewDateTime",type:"Ascii"},50972:{name:"RawImageDigest",type:"Undefined"},50973:{name:"OriginalRawFileDigest",type:"Undefined"},50974:{name:"SubTileBlockSize",type:"Long"},50975:{name:"RowInterleaveFactor",type:"Long"},50981:{name:"ProfileLookTableDims",type:"Long"},50982:{name:"ProfileLookTableData",type:"Float"},51008:{name:"OpcodeList1",type:"Undefined"},51009:{name:"OpcodeList2",type:"Undefined"},51022:{name:"OpcodeList3",type:"Undefined"}},Exif:{33434:{name:"ExposureTime",type:"Rational"},33437:{name:"FNumber",type:"Rational"},34850:{name:"ExposureProgram",type:"Short"},34852:{name:"SpectralSensitivity",type:"Ascii"},34855:{name:"ISOSpeedRatings",type:"Short"},34856:{name:"OECF",type:"Undefined"},34864:{name:"SensitivityType",type:"Short"},34865:{name:"StandardOutputSensitivity",type:"Long"},34866:{name:"RecommendedExposureIndex",type:"Long"},34867:{name:"ISOSpeed",type:"Long"},34868:{name:"ISOSpeedLatitudeyyy",type:"Long"},34869:{name:"ISOSpeedLatitudezzz",type:"Long"},36864:{name:"ExifVersion",type:"Undefined"},36867:{name:"DateTimeOriginal",type:"Ascii"},36868:{name:"DateTimeDigitized",type:"Ascii"},37121:{name:"ComponentsConfiguration",type:"Undefined"},37122:{name:"CompressedBitsPerPixel",type:"Rational"},37377:{name:"ShutterSpeedValue",type:"SRational"},37378:{name:"ApertureValue",type:"Rational"},37379:{name:"BrightnessValue",type:"SRational"},37380:{name:"ExposureBiasValue",type:"SRational"},37381:{name:"MaxApertureValue",type:"Rational"},37382:{name:"SubjectDistance",type:"Rational"},37383:{name:"MeteringMode",type:"Short"},37384:{name:"LightSource",type:"Short"},37385:{name:"Flash",type:"Short"},37386:{name:"FocalLength",type:"Rational"},37396:{name:"SubjectArea",type:"Short"},37500:{name:"MakerNote",type:"Undefined"},37510:{name:"UserComment",type:"Ascii"},37520:{name:"SubSecTime",type:"Ascii"},37521:{name:"SubSecTimeOriginal",type:"Ascii"},37522:{name:"SubSecTimeDigitized",type:"Ascii"},40960:{name:"FlashpixVersion",type:"Undefined"},40961:{name:"ColorSpace",type:"Short"},40962:{name:"PixelXDimension",type:"Long"},40963:{name:"PixelYDimension",type:"Long"},40964:{name:"RelatedSoundFile",type:"Ascii"},40965:{name:"InteroperabilityTag",type:"Long"},41483:{name:"FlashEnergy",type:"Rational"},41484:{name:"SpatialFrequencyResponse",type:"Undefined"},41486:{name:"FocalPlaneXResolution",type:"Rational"},41487:{name:"FocalPlaneYResolution",type:"Rational"},41488:{name:"FocalPlaneResolutionUnit",type:"Short"},41492:{name:"SubjectLocation",type:"Short"},41493:{name:"ExposureIndex",type:"Rational"},41495:{name:"SensingMethod",type:"Short"},41728:{name:"FileSource",type:"Undefined"},41729:{name:"SceneType",type:"Undefined"},41730:{name:"CFAPattern",type:"Undefined"},41985:{name:"CustomRendered",type:"Short"},41986:{name:"ExposureMode",type:"Short"},41987:{name:"WhiteBalance",type:"Short"},41988:{name:"DigitalZoomRatio",type:"Rational"},41989:{name:"FocalLengthIn35mmFilm",type:"Short"},41990:{name:"SceneCaptureType",type:"Short"},41991:{name:"GainControl",type:"Short"},41992:{name:"Contrast",type:"Short"},41993:{name:"Saturation",type:"Short"},41994:{name:"Sharpness",type:"Short"},41995:{name:"DeviceSettingDescription",type:"Undefined"},41996:{name:"SubjectDistanceRange",type:"Short"},42016:{name:"ImageUniqueID",type:"Ascii"},42032:{name:"CameraOwnerName",type:"Ascii"},42033:{name:"BodySerialNumber",type:"Ascii"},42034:{name:"LensSpecification",type:"Rational"},42035:{name:"LensMake",type:"Ascii"},42036:{name:"LensModel",type:"Ascii"},42037:{name:"LensSerialNumber",type:"Ascii"},42240:{name:"Gamma",type:"Rational"}},GPS:{0:{name:"GPSVersionID",type:"Byte"},1:{name:"GPSLatitudeRef",type:"Ascii"},2:{name:"GPSLatitude",type:"Rational"},3:{name:"GPSLongitudeRef",type:"Ascii"},4:{name:"GPSLongitude",type:"Rational"},5:{name:"GPSAltitudeRef",type:"Byte"},6:{name:"GPSAltitude",type:"Rational"},7:{name:"GPSTimeStamp",type:"Rational"},8:{name:"GPSSatellites",type:"Ascii"},9:{name:"GPSStatus",type:"Ascii"},10:{name:"GPSMeasureMode",type:"Ascii"},11:{name:"GPSDOP",type:"Rational"},12:{name:"GPSSpeedRef",type:"Ascii"},13:{name:"GPSSpeed",type:"Rational"},14:{name:"GPSTrackRef",type:"Ascii"},15:{name:"GPSTrack",type:"Rational"},16:{name:"GPSImgDirectionRef",type:"Ascii"},17:{name:"GPSImgDirection",type:"Rational"},18:{name:"GPSMapDatum",type:"Ascii"},19:{name:"GPSDestLatitudeRef",type:"Ascii"},20:{name:"GPSDestLatitude",type:"Rational"},21:{name:"GPSDestLongitudeRef",type:"Ascii"},22:{name:"GPSDestLongitude",type:"Rational"},23:{name:"GPSDestBearingRef",type:"Ascii"},24:{name:"GPSDestBearing",type:"Rational"},25:{name:"GPSDestDistanceRef",type:"Ascii"},26:{name:"GPSDestDistance",type:"Rational"},27:{name:"GPSProcessingMethod",type:"Undefined"},28:{name:"GPSAreaInformation",type:"Undefined"},29:{name:"GPSDateStamp",type:"Ascii"},30:{name:"GPSDifferential",type:"Short"},31:{name:"GPSHPositioningError",type:"Rational"}},Interop:{1:{name:"InteroperabilityIndex",type:"Ascii"}}};I["0th"]=I.Image,I["1st"]=I.Image,t.TAGS=I,t.ImageIFD={ProcessingSoftware:11,NewSubfileType:254,SubfileType:255,ImageWidth:256,ImageLength:257,BitsPerSample:258,Compression:259,PhotometricInterpretation:262,Threshholding:263,CellWidth:264,CellLength:265,FillOrder:266,DocumentName:269,ImageDescription:270,Make:271,Model:272,StripOffsets:273,Orientation:274,SamplesPerPixel:277,RowsPerStrip:278,StripByteCounts:279,XResolution:282,YResolution:283,PlanarConfiguration:284,GrayResponseUnit:290,GrayResponseCurve:291,T4Options:292,T6Options:293,ResolutionUnit:296,TransferFunction:301,Software:305,DateTime:306,Artist:315,HostComputer:316,Predictor:317,WhitePoint:318,PrimaryChromaticities:319,ColorMap:320,HalftoneHints:321,TileWidth:322,TileLength:323,TileOffsets:324,TileByteCounts:325,SubIFDs:330,InkSet:332,InkNames:333,NumberOfInks:334,DotRange:336,TargetPrinter:337,ExtraSamples:338,SampleFormat:339,SMinSampleValue:340,SMaxSampleValue:341,TransferRange:342,ClipPath:343,XClipPathUnits:344,YClipPathUnits:345,Indexed:346,JPEGTables:347,OPIProxy:351,JPEGProc:512,JPEGInterchangeFormat:513,JPEGInterchangeFormatLength:514,JPEGRestartInterval:515,JPEGLosslessPredictors:517,JPEGPointTransforms:518,JPEGQTables:519,JPEGDCTables:520,JPEGACTables:521,YCbCrCoefficients:529,YCbCrSubSampling:530,YCbCrPositioning:531,ReferenceBlackWhite:532,XMLPacket:700,Rating:18246,RatingPercent:18249,ImageID:32781,CFARepeatPatternDim:33421,CFAPattern:33422,BatteryLevel:33423,Copyright:33432,ExposureTime:33434,ImageResources:34377,ExifTag:34665,InterColorProfile:34675,GPSTag:34853,Interlace:34857,TimeZoneOffset:34858,SelfTimerMode:34859,FlashEnergy:37387,SpatialFrequencyResponse:37388,Noise:37389,FocalPlaneXResolution:37390,FocalPlaneYResolution:37391,FocalPlaneResolutionUnit:37392,ImageNumber:37393,SecurityClassification:37394,ImageHistory:37395,ExposureIndex:37397,TIFFEPStandardID:37398,SensingMethod:37399,XPTitle:40091,XPComment:40092,XPAuthor:40093,XPKeywords:40094,XPSubject:40095,PrintImageMatching:50341,DNGVersion:50706,DNGBackwardVersion:50707,UniqueCameraModel:50708,LocalizedCameraModel:50709,CFAPlaneColor:50710,CFALayout:50711,LinearizationTable:50712,BlackLevelRepeatDim:50713,BlackLevel:50714,BlackLevelDeltaH:50715,BlackLevelDeltaV:50716,WhiteLevel:50717,DefaultScale:50718,DefaultCropOrigin:50719,DefaultCropSize:50720,ColorMatrix1:50721,ColorMatrix2:50722,CameraCalibration1:50723,CameraCalibration2:50724,ReductionMatrix1:50725,ReductionMatrix2:50726,AnalogBalance:50727,AsShotNeutral:50728,AsShotWhiteXY:50729,BaselineExposure:50730,BaselineNoise:50731,BaselineSharpness:50732,BayerGreenSplit:50733,LinearResponseLimit:50734,CameraSerialNumber:50735,LensInfo:50736,ChromaBlurRadius:50737,AntiAliasStrength:50738,ShadowScale:50739,DNGPrivateData:50740,MakerNoteSafety:50741,CalibrationIlluminant1:50778,CalibrationIlluminant2:50779,BestQualityScale:50780,RawDataUniqueID:50781,OriginalRawFileName:50827,OriginalRawFileData:50828,ActiveArea:50829,MaskedAreas:50830,AsShotICCProfile:50831,AsShotPreProfileMatrix:50832,CurrentICCProfile:50833,CurrentPreProfileMatrix:50834,ColorimetricReference:50879,CameraCalibrationSignature:50931,ProfileCalibrationSignature:50932,AsShotProfileName:50934,NoiseReductionApplied:50935,ProfileName:50936,ProfileHueSatMapDims:50937,ProfileHueSatMapData1:50938,ProfileHueSatMapData2:50939,ProfileToneCurve:50940,ProfileEmbedPolicy:50941,ProfileCopyright:50942,ForwardMatrix1:50964,ForwardMatrix2:50965,PreviewApplicationName:50966,PreviewApplicationVersion:50967,PreviewSettingsName:50968,PreviewSettingsDigest:50969,PreviewColorSpace:50970,PreviewDateTime:50971,RawImageDigest:50972,OriginalRawFileDigest:50973,SubTileBlockSize:50974,RowInterleaveFactor:50975,ProfileLookTableDims:50981,ProfileLookTableData:50982,OpcodeList1:51008,OpcodeList2:51009,OpcodeList3:51022,NoiseProfile:51041},t.ExifIFD={ExposureTime:33434,FNumber:33437,ExposureProgram:34850,SpectralSensitivity:34852,ISOSpeedRatings:34855,OECF:34856,SensitivityType:34864,StandardOutputSensitivity:34865,RecommendedExposureIndex:34866,ISOSpeed:34867,ISOSpeedLatitudeyyy:34868,ISOSpeedLatitudezzz:34869,ExifVersion:36864,DateTimeOriginal:36867,DateTimeDigitized:36868,ComponentsConfiguration:37121,CompressedBitsPerPixel:37122,ShutterSpeedValue:37377,ApertureValue:37378,BrightnessValue:37379,ExposureBiasValue:37380,MaxApertureValue:37381,SubjectDistance:37382,MeteringMode:37383,LightSource:37384,Flash:37385,FocalLength:37386,SubjectArea:37396,MakerNote:37500,UserComment:37510,SubSecTime:37520,SubSecTimeOriginal:37521,SubSecTimeDigitized:37522,FlashpixVersion:40960,ColorSpace:40961,PixelXDimension:40962,PixelYDimension:40963,RelatedSoundFile:40964,InteroperabilityTag:40965,FlashEnergy:41483,SpatialFrequencyResponse:41484,FocalPlaneXResolution:41486,FocalPlaneYResolution:41487,FocalPlaneResolutionUnit:41488,SubjectLocation:41492,ExposureIndex:41493,SensingMethod:41495,FileSource:41728,SceneType:41729,CFAPattern:41730,CustomRendered:41985,ExposureMode:41986,WhiteBalance:41987,DigitalZoomRatio:41988,FocalLengthIn35mmFilm:41989,SceneCaptureType:41990,GainControl:41991,Contrast:41992,Saturation:41993,Sharpness:41994,DeviceSettingDescription:41995,SubjectDistanceRange:41996,ImageUniqueID:42016,CameraOwnerName:42032,BodySerialNumber:42033,LensSpecification:42034,LensMake:42035,LensModel:42036,LensSerialNumber:42037,Gamma:42240},t.GPSIFD={GPSVersionID:0,GPSLatitudeRef:1,GPSLatitude:2,GPSLongitudeRef:3,GPSLongitude:4,GPSAltitudeRef:5,GPSAltitude:6,GPSTimeStamp:7,GPSSatellites:8,GPSStatus:9,GPSMeasureMode:10,GPSDOP:11,GPSSpeedRef:12,GPSSpeed:13,GPSTrackRef:14,GPSTrack:15,GPSImgDirectionRef:16,GPSImgDirection:17,GPSMapDatum:18,GPSDestLatitudeRef:19,GPSDestLatitude:20,GPSDestLongitudeRef:21,GPSDestLongitude:22,GPSDestBearingRef:23,GPSDestBearing:24,GPSDestDistanceRef:25,GPSDestDistance:26,GPSProcessingMethod:27,GPSAreaInformation:28,GPSDateStamp:29,GPSDifferential:30,GPSHPositioningError:31},t.InteropIFD={InteroperabilityIndex:1},t.GPSHelper={degToDmsRational:function(u){var f=Math.abs(u),m=f%1*60,g=m%1*60,y=Math.floor(f),h=Math.floor(m),D=Math.round(g*100);return[[y,1],[h,1],[D,100]]},dmsRationalToDeg:function(u,f){var m=f==="S"||f==="W"?-1:1,g=u[0][0]/u[0][1]+u[1][0]/u[1][1]/60+u[2][0]/u[2][1]/3600;return g*m}},n.exports&&(e=n.exports=t),e.piexif=t})()})(at,at.exports);var Oe=at.exports;function hn(n,e){try{const t={},i={},l={};t[Oe.ImageIFD.Make]="LCM Image-to-Image ControNet",t[Oe.ImageIFD.ImageDescription]=`prompt: ${e==null?void 0:e.prompt} | negative_prompt: ${e==null?void 0:e.negative_prompt} | seed: ${e==null?void 0:e.seed} | guidance_scale: ${e==null?void 0:e.guidance_scale}`,t[Oe.ImageIFD.Software]="https://github.com/radames/Real-Time-Latent-Consistency-Model",i[Oe.ExifIFD.DateTimeOriginal]=new Date().toISOString();const s={"0th":t,Exif:i,GPS:l},a=Oe.dump(s),o=document.createElement("canvas");o.width=n.naturalWidth,o.height=n.naturalHeight,o.getContext("2d").drawImage(n,0,0);const c=o.toDataURL("image/jpeg"),k=Oe.insert(a,c),v=document.createElement("a");v.href=k,v.download=`lcm_txt_2_img${Date.now()}.png`,v.click()}catch(t){console.log(t)}}function gn(n){let e,t;return{c(){e=L("img"),this.h()},l(i){e=R(i,"IMG",{class:!0,src:!0}),this.h()},h(){p(e,"class","aspect-square w-full rounded-lg"),He(e.src,t="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=")||p(e,"src",t)},m(i,l){O(i,e,l)},p:le,i:le,o:le,d(i){i&&b(e)}}}function _n(n){let e,t,i,l,s,a,o="FPS",r,c,k=(n[0]&&n[2]>0?n[2].toFixed(1):"0.0")+"",v,_,d,S,E,T,w,C,x;return T=new Ge({props:{disabled:!n[0],title:"Take Snapshot",classList:"text-sm ml-auto text-white p-1 shadow-lg rounded-lg opacity-50",$$slots:{default:[vn]},$$scope:{ctx:n}}}),T.$on("click",n[6]),{c(){e=L("img"),i=U(),l=L("div"),s=L("div"),a=L("span"),a.textContent=o,r=U(),c=L("span"),v=se(k),_=U(),d=L("div"),S=U(),E=L("div"),ee(T.$$.fragment),this.h()},l(I){e=R(I,"IMG",{class:!0,src:!0}),i=z(I),l=R(I,"DIV",{class:!0});var u=$(l);s=R(u,"DIV",{class:!0});var f=$(s);a=R(f,"SPAN",{class:!0,"data-svelte-h":!0}),fe(a)!=="svelte-1p091b2"&&(a.textContent=o),r=z(f),c=R(f,"SPAN",{class:!0,style:!0});var m=$(c);v=oe(m,k),m.forEach(b),f.forEach(b),_=z(u),d=R(u,"DIV",{class:!0}),$(d).forEach(b),u.forEach(b),S=z(I),E=R(I,"DIV",{class:!0});var g=$(E);te(T.$$.fragment,g),g.forEach(b),this.h()},h(){p(e,"class","aspect-square w-full rounded-lg"),He(e.src,t="/api/stream/"+n[3])||p(e,"src",t),p(a,"class","text-[10px] font-medium text-gray-300 uppercase tracking-[0.15em] leading-none"),p(c,"class","text-3xl font-bold text-white tabular-nums select-none"),we(c,"font-family","'SF Mono', 'Monaco', 'Cascadia Code', 'Roboto Mono', 'Consolas', monospace"),we(c,"letter-spacing","-0.03em"),we(c,"text-shadow","0 2px 10px rgba(0,0,0,0.8), 0 0 20px rgba(59, 130, 246, 0.5)"),we(c,"min-width","3.5rem"),p(s,"class","flex items-baseline gap-3"),p(d,"class","absolute -bottom-1 left-1/2 transform -translate-x-1/2 w-8 h-0.5 bg-gradient-to-r from-transparent via-blue-400/50 to-transparent"),p(l,"class","absolute top-4 left-4 z-50 bg-gradient-to-br from-black/90 via-black/85 to-black/80 backdrop-blur-md rounded-xl px-5 py-3 shadow-2xl border-2 border-white/30"),p(E,"class","absolute bottom-1 right-1")},m(I,u){O(I,e,u),n[8](e),O(I,i,u),O(I,l,u),P(l,s),P(s,a),P(s,r),P(s,c),P(c,v),P(l,_),P(l,d),O(I,S,u),O(I,E,u),ne(T,E,null),w=!0,C||(x=[ue(e,"load",n[4]),ue(e,"error",n[5])],C=!0)},p(I,u){(!w||u&8&&!He(e.src,t="/api/stream/"+I[3]))&&p(e,"src",t),(!w||u&5)&&k!==(k=(I[0]&&I[2]>0?I[2].toFixed(1):"0.0")+"")&&Le(v,k);const f={};u&1&&(f.disabled=!I[0]),u&8388608&&(f.$$scope={dirty:u,ctx:I}),T.$set(f)},i(I){w||(A(T.$$.fragment,I),w=!0)},o(I){G(T.$$.fragment,I),w=!1},d(I){I&&(b(e),b(i),b(l),b(S),b(E)),n[8](null),ae(T),C=!1,it(x)}}}function vn(n){let e,t;return e=new pn({props:{classList:""}}),{c(){ee(e.$$.fragment)},l(i){te(e.$$.fragment,i)},m(i,l){ne(e,i,l),t=!0},p:le,i(i){t||(A(e.$$.fragment,i),t=!0)},o(i){G(e.$$.fragment,i),t=!1},d(i){ae(e,i)}}}function yn(n){let e,t,i,l;const s=[_n,gn],a=[];function o(r,c){return r[0]&&r[3]?0:1}return t=o(n),i=a[t]=s[t](n),{c(){e=L("div"),i.c(),this.h()},l(r){e=R(r,"DIV",{class:!0});var c=$(e);i.l(c),c.forEach(b),this.h()},h(){p(e,"class","relative mx-auto aspect-square max-w-lg self-center overflow-hidden rounded-lg border border-slate-300")},m(r,c){O(r,e,c),a[t].m(e,null),l=!0},p(r,[c]){let k=t;t=o(r),t===k?a[t].p(r,c):(me(),G(a[k],1,1,()=>{a[k]=null}),pe(),i=a[t],i?i.p(r,c):(i=a[t]=s[t](r),i.c()),A(i,1),i.m(e,null))},i(r){l||(A(i),l=!0)},o(r){G(i),l=!1},d(r){r&&b(e),a[t].d()}}}const bn=30;function Sn(n,e,t){let i,l,s;Ie(n,Ae,g=>t(7,l=g)),Ie(n,Ne,g=>t(3,s=g));let a,o=0,r=0;const c=[];let k=null,v=null,_=null;function d(){const g=performance.now();if(c.push(g),c.length>bn&&c.shift(),c.length>=2){const y=c[c.length-1]-c[0];o=(c.length-1)/y*1e3}}function S(){i&&a&&d()}let E=0,T=0,w=0;function C(){if(!i||!a)return;const g=performance.now();if(a.complete&&a.naturalWidth>0&&g-E>16){T++,w===0&&(w=g);const h=g-w;h>=1e3&&(o=T/h*1e3,T=0,w=g),E=g}}function x(){i||u()}function I(){if(k)return;k=setInterval(()=>{o>0?t(2,r=r*.7+o*.3):r>0&&t(2,r=r*.9)},100);const g=()=>{i?(C(),_=requestAnimationFrame(g)):_=null};_=requestAnimationFrame(g),v=setInterval(()=>{i&&C()},33)}function u(){k&&(clearInterval(k),k=null),v&&(clearInterval(v),v=null),_!==null&&(cancelAnimationFrame(_),_=null),o=0,t(2,r=0),c.length=0,E=0,T=0,w=0}Mt(()=>{u()});async function f(){var g,y,h,D;i&&await hn(a,{prompt:(g=Ve())==null?void 0:g.prompt,negative_prompt:(y=Ve())==null?void 0:y.negative_prompt,seed:(h=Ve())==null?void 0:h.seed,guidance_scale:(D=Ve())==null?void 0:D.guidance_scale})}function m(g){de[g?"unshift":"push"](()=>{a=g,t(1,a)})}return n.$$.update=()=>{n.$$.dirty&128&&t(0,i=l!==Ze.DISCONNECTED),n.$$.dirty&1&&console.log("isLCMRunning",i),n.$$.dirty&1&&(i?I():u())},[i,a,r,s,S,x,f,l,m]}class kn extends ge{constructor(e){super(),_e(this,e,Sn,yn,he,{})}}typeof HTMLVideoElement<"u"&&!("requestVideoFrameCallback"in HTMLVideoElement.prototype)&&"getVideoPlaybackQuality"in HTMLVideoElement.prototype&&(HTMLVideoElement.prototype._rvfcpolyfillmap={},HTMLVideoElement.prototype.requestVideoFrameCallback=function(n){const e=performance.now(),t=this.getVideoPlaybackQuality(),i=this.mozPresentedFrames||this.mozPaintedFrames||t.totalVideoFrames-t.droppedVideoFrames,l=(s,a)=>{const o=this.getVideoPlaybackQuality(),r=this.mozPresentedFrames||this.mozPaintedFrames||o.totalVideoFrames-o.droppedVideoFrames;if(r>i){const c=this.mozFrameDelay||o.totalFrameDelay-t.totalFrameDelay||0,k=a-s;n(a,{presentationTime:a+c*1e3,expectedDisplayTime:a+k,width:this.videoWidth,height:this.videoHeight,mediaTime:Math.max(0,this.currentTime||0)+k/1e3,presentedFrames:r,processingDuration:c}),delete this._rvfcpolyfillmap[e]}else this._rvfcpolyfillmap[e]=requestAnimationFrame(c=>l(a,c))};return this._rvfcpolyfillmap[e]=requestAnimationFrame(s=>l(e,s)),e},HTMLVideoElement.prototype.cancelVideoFrameCallback=function(n){cancelAnimationFrame(this._rvfcpolyfillmap[n]),delete this._rvfcpolyfillmap[n]});var Vt=(n=>(n.INIT="init",n.CONNECTED="connected",n.DISCONNECTED="disconnected",n))(Vt||{});const Ht=Me({blob:new Blob}),rt=Me([]),$e=Me("init"),Be=Me(null),Ye={async enumerateDevices(){await navigator.mediaDevices.enumerateDevices().then(n=>{const e=n.filter(t=>t.kind==="videoinput");rt.set(e)}).catch(n=>{console.error(n)})},async start(n){const e={audio:!1,video:{width:1024,height:1024,deviceId:n}};await navigator.mediaDevices.getUserMedia(e).then(t=>{$e.set("connected"),Be.set(t)}).catch(t=>{console.error(`${t.name}: ${t.message}`),$e.set("disconnected"),Be.set(null)})},async startScreenCapture(){const n={video:{displaySurface:"window"},audio:!1,surfaceSwitching:"include"};let e=null;try{e=await navigator.mediaDevices.getDisplayMedia(n);const t=e.getVideoTracks()[0];console.log("Track settings:"),console.log(JSON.stringify(t.getSettings(),null,2)),console.log("Track constraints:"),console.log(JSON.stringify(t.getConstraints(),null,2)),$e.set("connected"),Be.set(e)}catch(t){console.error(t)}},async switchCamera(n){if(Gt($e)!=="connected")return;const e={audio:!1,video:{width:1024,height:1024,deviceId:n}};await navigator.mediaDevices.getUserMedia(e).then(t=>{$e.set("connected"),Be.set(t)}).catch(t=>{console.error(`${t.name}: ${t.message}`)})},async stop(){navigator.mediaDevices.getUserMedia({video:!0}).then(n=>{n.getTracks().forEach(e=>e.stop())}),$e.set("disconnected"),Be.set(null)}};function Pn(n){let e,t;return{c(){e=Ue("svg"),t=Ue("path"),this.h()},l(i){e=ze(i,"svg",{xmlns:!0,viewBox:!0,height:!0,class:!0});var l=$(e);t=ze(l,"path",{fill:!0,d:!0}),$(t).forEach(b),l.forEach(b),this.h()},h(){p(t,"fill","currentColor"),p(t,"d","M64 0A64 64 0 0 0 0 64v288a64 64 0 0 0 64 64h176l-10.7 32H160a32 32 0 1 0 0 64h256a32 32 0 1 0 0-64h-69.3L336 416h176a64 64 0 0 0 64-64V64a64 64 0 0 0-64-64H64zm448 64v288H64V64h448z"),p(e,"xmlns","http://www.w3.org/2000/svg"),p(e,"viewBox","0 -32 576 576"),p(e,"height","16px"),p(e,"class",n[0])},m(i,l){O(i,e,l),P(e,t)},p(i,[l]){l&1&&p(e,"class",i[0])},i:le,o:le,d(i){i&&b(e)}}}function wn(n,e,t){let{classList:i=""}=e;return n.$$set=l=>{"classList"in l&&t(0,i=l.classList)},[i]}class Cn extends ge{constructor(e){super(),_e(this,e,wn,Pn,he,{classList:0})}}function dt(n,e,t){const i=n.slice();return i[5]=e[t],i[7]=t,i}function mt(n){let e,t,i,l=xe(n[1]),s=[];for(let a=0;a<l.length;a+=1)s[a]=pt(dt(n,l,a));return{c(){e=L("select");for(let a=0;a<s.length;a+=1)s[a].c();this.h()},l(a){e=R(a,"SELECT",{id:!0,class:!0});var o=$(e);for(let r=0;r<s.length;r+=1)s[r].l(o);o.forEach(b),this.h()},h(){p(e,"id","devices-list"),p(e,"class","border-1 block cursor-pointer rounded-md border-gray-800 border-opacity-50 bg-slate-100 bg-opacity-30 p-1 font-medium text-white"),n[0]===void 0&&Ot(()=>n[3].call(e))},m(a,o){O(a,e,o);for(let r=0;r<s.length;r+=1)s[r]&&s[r].m(e,null);Ke(e,n[0],!0),t||(i=[ue(e,"change",n[3]),ue(e,"change",n[4])],t=!0)},p(a,o){if(o&2){l=xe(a[1]);let r;for(r=0;r<l.length;r+=1){const c=dt(a,l,r);s[r]?s[r].p(c,o):(s[r]=pt(c),s[r].c(),s[r].m(e,null))}for(;r<s.length;r+=1)s[r].d(1);s.length=l.length}o&3&&Ke(e,a[0])},d(a){a&&b(e),et(s,a),t=!1,it(i)}}}function pt(n){let e,t=n[5].label+"",i,l;return{c(){e=L("option"),i=se(t),this.h()},l(s){e=R(s,"OPTION",{});var a=$(e);i=oe(a,t),a.forEach(b),this.h()},h(){e.__value=l=n[5].deviceId,ye(e,e.__value)},m(s,a){O(s,e,a),P(e,i)},p(s,a){a&2&&t!==(t=s[5].label+"")&&Le(i,t),a&2&&l!==(l=s[5].deviceId)&&(e.__value=l,ye(e,e.__value))},d(s){s&&b(e)}}}function En(n){let e,t,i,l="Share",s,a,o,r,c,k;a=new Cn({props:{classList:""}});let v=n[1]&&mt(n);return{c(){e=L("div"),t=L("button"),i=L("span"),i.textContent=l,s=U(),ee(a.$$.fragment),o=U(),v&&v.c(),this.h()},l(_){e=R(_,"DIV",{class:!0});var d=$(e);t=R(d,"BUTTON",{title:!0,class:!0});var S=$(t);i=R(S,"SPAN",{"data-svelte-h":!0}),fe(i)!=="svelte-1ahaqi7"&&(i.textContent=l),s=z(S),te(a.$$.fragment,S),S.forEach(b),o=z(d),v&&v.l(d),d.forEach(b),this.h()},h(){p(t,"title","Share your screen"),p(t,"class","border-1 my-1 flex cursor-pointer gap-1 rounded-md border-gray-500 border-opacity-50 bg-slate-100 bg-opacity-30 p-1 font-medium text-white"),p(e,"class","flex items-center justify-center text-xs")},m(_,d){O(_,e,d),P(e,t),P(t,i),P(t,s),ne(a,t,null),P(e,o),v&&v.m(e,null),r=!0,c||(k=ue(t,"click",n[2]),c=!0)},p(_,[d]){_[1]?v?v.p(_,d):(v=mt(_),v.c(),v.m(e,null)):v&&(v.d(1),v=null)},i(_){r||(A(a.$$.fragment,_),r=!0)},o(_){G(a.$$.fragment,_),r=!1},d(_){_&&b(e),ae(a),v&&v.d(),c=!1,k()}}}function In(n,e,t){let i;Ie(n,rt,r=>t(1,i=r));let l="";Fe(()=>{t(0,l=i[0].deviceId)});const s=()=>Ye.startScreenCapture();function a(){l=Nt(this),t(0,l)}const o=()=>Ye.switchCamera(l);return n.$$.update=()=>{n.$$.dirty&2&&console.log(i),n.$$.dirty&1&&console.log(l)},[l,i,s,a,o]}class Ln extends ge{constructor(e){super(),_e(this,e,In,En,he,{})}}function ht(n){let e,t,i;return t=new Ln({}),{c(){e=L("div"),ee(t.$$.fragment),this.h()},l(l){e=R(l,"DIV",{class:!0});var s=$(e);te(t.$$.fragment,s),s.forEach(b),this.h()},h(){p(e,"class","absolute bottom-0 right-0 z-10")},m(l,s){O(l,e,s),ne(t,e,null),i=!0},i(l){i||(A(t.$$.fragment,l),i=!0)},o(l){G(t.$$.fragment,l),i=!1},d(l){l&&b(e),ae(t)}}}function Rn(n){let e,t,i,l,s,a,o,r,c='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 448" class="w-40 p-5 opacity-20"><path fill="currentColor" d="M224 256a128 128 0 1 0 0-256 128 128 0 1 0 0 256zm-45.7 48A178.3 178.3 0 0 0 0 482.3 29.7 29.7 0 0 0 29.7 512h388.6a29.7 29.7 0 0 0 29.7-29.7c0-98.5-79.8-178.3-178.3-178.3h-91.4z"></path></svg>',k,v,_,d=n[3].length>0&&ht();return{c(){e=L("div"),t=L("div"),d&&d.c(),i=U(),l=L("video"),s=U(),a=L("canvas"),o=U(),r=L("div"),r.innerHTML=c,this.h()},l(S){e=R(S,"DIV",{class:!0});var E=$(e);t=R(E,"DIV",{class:!0});var T=$(t);d&&d.l(T),i=z(T),l=R(T,"VIDEO",{class:!0}),$(l).forEach(b),s=z(T),a=R(T,"CANVAS",{class:!0}),$(a).forEach(b),T.forEach(b),o=z(E),r=R(E,"DIV",{class:!0,"data-svelte-h":!0}),fe(r)!=="svelte-gk33v1"&&(r.innerHTML=c),E.forEach(b),this.h()},h(){p(l,"class","pointer-events-none aspect-square w-full object-cover"),l.playsInline=!0,l.autoplay=!0,l.muted=!0,l.loop=!0,p(a,"class","absolute left-0 top-0 aspect-square w-full object-cover"),p(t,"class","relative z-10 aspect-square w-full object-cover"),p(r,"class","absolute left-0 top-0 flex aspect-square w-full items-center justify-center"),p(e,"class","relative mx-auto max-w-lg overflow-hidden rounded-lg border border-slate-300")},m(S,E){O(S,e,E),P(e,t),d&&d.m(t,null),P(t,i),P(t,l),n[8](l),P(t,s),P(t,a),n[10](a),P(e,o),P(e,r),k=!0,v||(_=ue(l,"loadeddata",n[9]),v=!0)},p(S,[E]){S[3].length>0?d?E&8&&A(d,1):(d=ht(),d.c(),A(d,1),d.m(t,i)):d&&(me(),G(d,1,1,()=>{d=null}),pe())},i(S){k||(A(d),k=!0)},o(S){G(d),k=!1},d(S){S&&b(e),d&&d.d(),n[8](null),n[10](null),v=!1,_()}}}let Dn="",An=0;function Tn(n,e,t){let i,l,s;Ie(n,$e,x=>t(6,i=x)),Ie(n,Be,x=>t(7,l=x)),Ie(n,rt,x=>t(3,s=x));let{width:a=512}=e,{height:o=512}=e;const r={width:a,height:o};let c,k,v,_;const d=1e3/120;let S=!1;Fe(()=>{v=k.getContext("2d"),t(2,k.width=r.width,k),t(2,k.height=r.height,k)}),Mt(()=>{_&&c.cancelVideoFrameCallback(_)});async function E(x,I){if(x-An<d){_=c.requestVideoFrameCallback(E);return}const u=c.videoWidth,f=c.videoHeight;let m=f,g=u,y=0,h=0;u>f?(g=f,y=(u-f)/2):(m=u,h=(f-u)/2),v.drawImage(c,y,h,g,m,0,0,r.width,r.height);const D=await new Promise(N=>{k.toBlob(B=>{N(B)},"image/jpeg",1)});Ht.set({blob:D}),_=c.requestVideoFrameCallback(E)}function T(x){de[x?"unshift":"push"](()=>{c=x,t(0,c),t(7,l)})}const w=()=>{t(1,S=!0)};function C(x){de[x?"unshift":"push"](()=>{k=x,t(2,k)})}return n.$$set=x=>{"width"in x&&t(4,a=x.width),"height"in x&&t(5,o=x.height)},n.$$.update=()=>{n.$$.dirty&129&&c&&t(0,c.srcObject=l,c),n.$$.dirty&67&&i==Vt.CONNECTED&&S&&(_=c.requestVideoFrameCallback(E))},console.log(Dn),[c,S,k,s,a,o,i,l,T,w,C]}class xn extends ge{constructor(e){super(),_e(this,e,Tn,Rn,he,{width:4,height:5})}}function Fn(n){var x;let e,t,i=((x=n[1])==null?void 0:x.title)+"",l,s,a,o,r,c,k,v,_,d,S,E,T,w,C;return{c(){e=L("div"),t=L("label"),l=se(i),a=U(),o=L("div"),r=L("input"),S=U(),E=L("input"),this.h()},l(I){e=R(I,"DIV",{class:!0});var u=$(e);t=R(u,"LABEL",{class:!0,for:!0,style:!0});var f=$(t);l=oe(f,i),f.forEach(b),a=z(u),o=R(u,"DIV",{class:!0});var m=$(o);r=R(m,"INPUT",{class:!0,type:!0,id:!0,name:!0,min:!0,max:!0,step:!0,style:!0}),m.forEach(b),S=z(u),E=R(u,"INPUT",{type:!0,step:!0,class:!0,style:!0}),u.forEach(b),this.h()},h(){var I,u,f,m;p(t,"class","text-sm font-semibold text-gray-700 dark:text-gray-300"),p(t,"for",s=n[1].id),we(t,"font-family","'Inter', 'SF Pro Display', -apple-system, sans-serif"),p(r,"class","w-full cursor-pointer appearance-none svelte-vp5c1k"),p(r,"type","range"),p(r,"id",c=n[1].id),p(r,"name",k=n[1].id),p(r,"min",v=(I=n[1])==null?void 0:I.min),p(r,"max",_=(u=n[1])==null?void 0:u.max),p(r,"step",d=((f=n[1])==null?void 0:f.step)??.1),we(r,"height","12px"),p(o,"class","col-span-2 relative flex items-center py-2"),p(E,"type","number"),p(E,"step",T=((m=n[1])==null?void 0:m.step)??.1),p(E,"class","rounded-lg border-2 border-gray-300 dark:border-gray-600 px-3 py-1.5 text-center text-sm font-bold dark:text-black bg-white dark:bg-gray-100 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all shadow-sm"),we(E,"min-width","4rem"),p(e,"class","grid max-w-md grid-cols-4 items-center gap-4 py-2")},m(I,u){O(I,e,u),P(e,t),P(t,l),P(e,a),P(e,o),P(o,r),ye(r,n[0]),P(e,S),P(e,E),ye(E,n[0]),w||(C=[ue(r,"change",n[2]),ue(r,"input",n[2]),ue(E,"input",n[3])],w=!0)},p(I,[u]){var f,m,g,y,h;u&2&&i!==(i=((f=I[1])==null?void 0:f.title)+"")&&Le(l,i),u&2&&s!==(s=I[1].id)&&p(t,"for",s),u&2&&c!==(c=I[1].id)&&p(r,"id",c),u&2&&k!==(k=I[1].id)&&p(r,"name",k),u&2&&v!==(v=(m=I[1])==null?void 0:m.min)&&p(r,"min",v),u&2&&_!==(_=(g=I[1])==null?void 0:g.max)&&p(r,"max",_),u&2&&d!==(d=((y=I[1])==null?void 0:y.step)??.1)&&p(r,"step",d),u&1&&ye(r,I[0]),u&2&&T!==(T=((h=I[1])==null?void 0:h.step)??.1)&&p(E,"step",T),u&1&&Qe(E.value)!==I[0]&&ye(E,I[0])},i:le,o:le,d(I){I&&b(e),w=!1,it(C)}}}function $n(n,e,t){let{value:i=8}=e,{params:l}=e;Fe(()=>{t(0,i=Number(l==null?void 0:l.default)??8)});function s(){i=Qe(this.value),t(0,i)}function a(){i=Qe(this.value),t(0,i)}return n.$$set=o=>{"value"in o&&t(0,i=o.value),"params"in o&&t(1,l=o.params)},[i,l,s,a]}class lt extends ge{constructor(e){super(),_e(this,e,$n,Fn,he,{value:0,params:1})}}function Gn(n){let e;return{c(){e=se("Rand")},l(t){e=oe(t,"Rand")},m(t,i){O(t,e,i)},d(t){t&&b(e)}}}function Mn(n){let e,t,i="Seed",l,s,a,o,r,c,k;return o=new Ge({props:{$$slots:{default:[Gn]},$$scope:{ctx:n}}}),o.$on("click",n[1]),{c(){e=L("div"),t=L("label"),t.textContent=i,l=U(),s=L("input"),a=U(),ee(o.$$.fragment),this.h()},l(v){e=R(v,"DIV",{class:!0});var _=$(e);t=R(_,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),fe(t)!=="svelte-nnsryo"&&(t.textContent=i),l=z(_),s=R(_,"INPUT",{type:!0,id:!0,name:!0,class:!0}),a=z(_),te(o.$$.fragment,_),_.forEach(b),this.h()},h(){p(t,"class","text-sm font-medium"),p(t,"for","seed"),p(s,"type","number"),p(s,"id","seed"),p(s,"name","seed"),p(s,"class","col-span-2 rounded-md border border-gray-700 p-2 text-right font-light dark:text-black"),p(e,"class","grid max-w-md grid-cols-4 items-center gap-3")},m(v,_){O(v,e,_),P(e,t),P(e,l),P(e,s),ye(s,n[0]),P(e,a),ne(o,e,null),r=!0,c||(k=ue(s,"input",n[3]),c=!0)},p(v,[_]){_&1&&Qe(s.value)!==v[0]&&ye(s,v[0]);const d={};_&16&&(d.$$scope={dirty:_,ctx:v}),o.$set(d)},i(v){r||(A(o.$$.fragment,v),r=!0)},o(v){G(o.$$.fragment,v),r=!1},d(v){v&&b(e),ae(o),c=!1,k()}}}function On(n,e,t){let{value:i=299792458}=e,{params:l}=e;Fe(()=>{t(0,i=Number((l==null?void 0:l.default)??""))});function s(){t(0,i=Math.floor(Math.random()*Number.MAX_SAFE_INTEGER))}function a(){i=Qe(this.value),t(0,i)}return n.$$set=o=>{"value"in o&&t(0,i=o.value),"params"in o&&t(2,l=o.params)},[i,s,l,a]}class Ut extends ge{constructor(e){super(),_e(this,e,On,Mn,he,{value:0,params:2})}}function Nn(n){var _;let e,t,i=((_=n[1])==null?void 0:_.title)+"",l,s,a,o,r,c,k,v;return{c(){e=L("div"),t=L("label"),l=se(i),a=U(),o=L("div"),r=L("textarea"),this.h()},l(d){e=R(d,"DIV",{class:!0});var S=$(e);t=R(S,"LABEL",{class:!0,for:!0,style:!0});var E=$(t);l=oe(E,i),E.forEach(b),a=z(S),o=R(S,"DIV",{class:!0});var T=$(o);r=R(T,"TEXTAREA",{class:!0,title:!0,placeholder:!0,rows:!0}),$(r).forEach(b),T.forEach(b),S.forEach(b),this.h()},h(){var d,S;p(t,"class","block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2"),p(t,"for",s=(d=n[1])==null?void 0:d.title),we(t,"font-family","'Inter', 'SF Pro Display', -apple-system, sans-serif"),p(r,"class","mx-1 w-full px-4 py-3 font-normal text-gray-800 dark:text-black outline-none resize-none rounded-lg"),p(r,"title",c=(S=n[1])==null?void 0:S.title),p(r,"placeholder","Add your prompt here..."),p(r,"rows","3"),p(o,"class","text-normal flex items-center rounded-lg border-2 border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-100 shadow-sm focus-within:border-blue-500 focus-within:ring-2 focus-within:ring-blue-200 transition-all"),p(e,"class","py-2")},m(d,S){O(d,e,S),P(e,t),P(t,l),P(e,a),P(e,o),P(o,r),ye(r,n[0]),k||(v=ue(r,"input",n[2]),k=!0)},p(d,[S]){var E,T,w;S&2&&i!==(i=((E=d[1])==null?void 0:E.title)+"")&&Le(l,i),S&2&&s!==(s=(T=d[1])==null?void 0:T.title)&&p(t,"for",s),S&2&&c!==(c=(w=d[1])==null?void 0:w.title)&&p(r,"title",c),S&1&&ye(r,d[0])},i:le,o:le,d(d){d&&b(e),k=!1,v()}}}function Bn(n,e,t){let{value:i}=e,{params:l}=e;Fe(()=>{t(0,i=String((l==null?void 0:l.default)??""))});function s(){i=this.value,t(0,i)}return n.$$set=a=>{"value"in a&&t(0,i=a.value),"params"in a&&t(1,l=a.params)},[i,l,s]}class st extends ge{constructor(e){super(),_e(this,e,Bn,Nn,he,{value:0,params:1})}}function Vn(n){var v;let e,t,i=((v=n[1])==null?void 0:v.title)+"",l,s,a,o,r,c,k;return{c(){e=L("div"),t=L("label"),l=se(i),a=U(),o=L("input"),this.h()},l(_){e=R(_,"DIV",{class:!0});var d=$(e);t=R(d,"LABEL",{class:!0,for:!0});var S=$(t);l=oe(S,i),S.forEach(b),a=z(d),o=R(d,"INPUT",{type:!0,id:!0,class:!0}),d.forEach(b),this.h()},h(){p(t,"class","text-sm font-medium"),p(t,"for",s=n[1].id),p(o,"type","checkbox"),p(o,"id",r=n[1].id),p(o,"class","cursor-pointer"),p(e,"class","grid max-w-md grid-cols-4 items-center justify-items-start gap-3")},m(_,d){O(_,e,d),P(e,t),P(t,l),P(e,a),P(e,o),o.checked=n[0],c||(k=ue(o,"change",n[2]),c=!0)},p(_,[d]){var S;d&2&&i!==(i=((S=_[1])==null?void 0:S.title)+"")&&Le(l,i),d&2&&s!==(s=_[1].id)&&p(t,"for",s),d&2&&r!==(r=_[1].id)&&p(o,"id",r),d&1&&(o.checked=_[0])},i:le,o:le,d(_){_&&b(e),c=!1,k()}}}function Hn(n,e,t){let{value:i=!1}=e,{params:l}=e;Fe(()=>{t(0,i=!!(l!=null&&l.default))});function s(){i=this.checked,t(0,i)}return n.$$set=a=>{"value"in a&&t(0,i=a.value),"params"in a&&t(1,l=a.params)},[i,l,s]}class zt extends ge{constructor(e){super(),_e(this,e,Hn,Vn,he,{value:0,params:1})}}function gt(n,e,t){const i=n.slice();return i[3]=e[t],i[5]=t,i}function _t(n){let e,t,i,l=xe(n[1].values),s=[];for(let a=0;a<l.length;a+=1)s[a]=vt(gt(n,l,a));return{c(){e=L("select");for(let a=0;a<s.length;a+=1)s[a].c();this.h()},l(a){e=R(a,"SELECT",{id:!0,class:!0});var o=$(e);for(let r=0;r<s.length;r+=1)s[r].l(o);o.forEach(b),this.h()},h(){p(e,"id","model-list"),p(e,"class","cursor-pointer rounded-md border-2 border-gray-500 p-2 font-light dark:text-black"),n[0]===void 0&&Ot(()=>n[2].call(e))},m(a,o){O(a,e,o);for(let r=0;r<s.length;r+=1)s[r]&&s[r].m(e,null);Ke(e,n[0],!0),t||(i=ue(e,"change",n[2]),t=!0)},p(a,o){if(o&2){l=xe(a[1].values);let r;for(r=0;r<l.length;r+=1){const c=gt(a,l,r);s[r]?s[r].p(c,o):(s[r]=vt(c),s[r].c(),s[r].m(e,null))}for(;r<s.length;r+=1)s[r].d(1);s.length=l.length}o&3&&Ke(e,a[0])},d(a){a&&b(e),et(s,a),t=!1,i()}}}function vt(n){let e,t=n[3]+"",i,l;return{c(){e=L("option"),i=se(t),this.h()},l(s){e=R(s,"OPTION",{});var a=$(e);i=oe(a,t),a.forEach(b),this.h()},h(){e.__value=l=n[3],ye(e,e.__value),e.selected=n[5]===0},m(s,a){O(s,e,a),P(e,i)},p(s,a){a&2&&t!==(t=s[3]+"")&&Le(i,t),a&2&&l!==(l=s[3])&&(e.__value=l,ye(e,e.__value))},d(s){s&&b(e)}}}function Un(n){var o,r;let e,t,i=((o=n[1])==null?void 0:o.title)+"",l,s,a=((r=n[1])==null?void 0:r.values)&&_t(n);return{c(){e=L("div"),t=L("label"),l=se(i),s=U(),a&&a.c(),this.h()},l(c){e=R(c,"DIV",{class:!0});var k=$(e);t=R(k,"LABEL",{for:!0,class:!0});var v=$(t);l=oe(v,i),v.forEach(b),s=z(k),a&&a.l(k),k.forEach(b),this.h()},h(){p(t,"for","model-list"),p(t,"class","text-sm font-medium"),p(e,"class","grid max-w-md grid-cols-4 items-center justify-items-start gap-3")},m(c,k){O(c,e,k),P(e,t),P(t,l),P(e,s),a&&a.m(e,null)},p(c,[k]){var v,_;k&2&&i!==(i=((v=c[1])==null?void 0:v.title)+"")&&Le(l,i),(_=c[1])!=null&&_.values?a?a.p(c,k):(a=_t(c),a.c(),a.m(e,null)):a&&(a.d(1),a=null)},i:le,o:le,d(c){c&&b(e),a&&a.d()}}}function zn(n,e,t){let{value:i=""}=e,{params:l}=e;Fe(()=>{t(0,i=String(l==null?void 0:l.default))});function s(){i=Nt(this),t(0,i),t(1,l)}return n.$$set=a=>{"value"in a&&t(0,i=a.value),"params"in a&&t(1,l=a.params)},[i,l,s]}class jt extends ge{constructor(e){super(),_e(this,e,zn,Un,he,{value:0,params:1})}}function yt(n,e,t){const i=n.slice();return i[14]=e[t],i[15]=e,i[16]=t,i}function bt(n,e,t){const i=n.slice();return i[14]=e[t],i[17]=e,i[18]=t,i}function St(n){let e,t,i=xe(n[1]),l=[];for(let a=0;a<i.length;a+=1)l[a]=kt(bt(n,i,a));const s=a=>G(l[a],1,1,()=>{l[a]=null});return{c(){for(let a=0;a<l.length;a+=1)l[a].c();e=be()},l(a){for(let o=0;o<l.length;o+=1)l[o].l(a);e=be()},m(a,o){for(let r=0;r<l.length;r+=1)l[r]&&l[r].m(a,o);O(a,e,o),t=!0},p(a,o){if(o&10){i=xe(a[1]);let r;for(r=0;r<i.length;r+=1){const c=bt(a,i,r);l[r]?(l[r].p(c,o),A(l[r],1)):(l[r]=kt(c),l[r].c(),A(l[r],1),l[r].m(e.parentNode,e))}for(me(),r=i.length;r<l.length;r+=1)s(r);pe()}},i(a){if(!t){for(let o=0;o<i.length;o+=1)A(l[o]);t=!0}},o(a){l=l.filter(Boolean);for(let o=0;o<l.length;o+=1)G(l[o]);t=!1},d(a){a&&b(e),et(l,a)}}}function jn(n){let e,t,i;function l(a){n[8](a,n[14])}let s={params:n[14]};return n[3][n[14].id]!==void 0&&(s.value=n[3][n[14].id]),e=new jt({props:s}),de.push(()=>ke(e,"value",l)),{c(){ee(e.$$.fragment)},l(a){te(e.$$.fragment,a)},m(a,o){ne(e,a,o),i=!0},p(a,o){n=a;const r={};o&2&&(r.params=n[14]),!t&&o&10&&(t=!0,r.value=n[3][n[14].id],Se(()=>t=!1)),e.$set(r)},i(a){i||(A(e.$$.fragment,a),i=!0)},o(a){G(e.$$.fragment,a),i=!1},d(a){ae(e,a)}}}function qn(n){let e,t,i;function l(a){n[7](a,n[14])}let s={params:n[14]};return n[3][n[14].id]!==void 0&&(s.value=n[3][n[14].id]),e=new zt({props:s}),de.push(()=>ke(e,"value",l)),{c(){ee(e.$$.fragment)},l(a){te(e.$$.fragment,a)},m(a,o){ne(e,a,o),i=!0},p(a,o){n=a;const r={};o&2&&(r.params=n[14]),!t&&o&10&&(t=!0,r.value=n[3][n[14].id],Se(()=>t=!1)),e.$set(r)},i(a){i||(A(e.$$.fragment,a),i=!0)},o(a){G(e.$$.fragment,a),i=!1},d(a){ae(e,a)}}}function Wn(n){let e,t,i;function l(a){n[6](a,n[14])}let s={params:n[14]};return n[3][n[14].id]!==void 0&&(s.value=n[3][n[14].id]),e=new st({props:s}),de.push(()=>ke(e,"value",l)),{c(){ee(e.$$.fragment)},l(a){te(e.$$.fragment,a)},m(a,o){ne(e,a,o),i=!0},p(a,o){n=a;const r={};o&2&&(r.params=n[14]),!t&&o&10&&(t=!0,r.value=n[3][n[14].id],Se(()=>t=!1)),e.$set(r)},i(a){i||(A(e.$$.fragment,a),i=!0)},o(a){G(e.$$.fragment,a),i=!1},d(a){ae(e,a)}}}function Xn(n){let e,t,i;function l(a){n[5](a,n[14])}let s={params:n[14]};return n[3][n[14].id]!==void 0&&(s.value=n[3][n[14].id]),e=new Ut({props:s}),de.push(()=>ke(e,"value",l)),{c(){ee(e.$$.fragment)},l(a){te(e.$$.fragment,a)},m(a,o){ne(e,a,o),i=!0},p(a,o){n=a;const r={};o&2&&(r.params=n[14]),!t&&o&10&&(t=!0,r.value=n[3][n[14].id],Se(()=>t=!1)),e.$set(r)},i(a){i||(A(e.$$.fragment,a),i=!0)},o(a){G(e.$$.fragment,a),i=!1},d(a){ae(e,a)}}}function Jn(n){let e,t,i;function l(a){n[4](a,n[14])}let s={params:n[14]};return n[3][n[14].id]!==void 0&&(s.value=n[3][n[14].id]),e=new lt({props:s}),de.push(()=>ke(e,"value",l)),{c(){ee(e.$$.fragment)},l(a){te(e.$$.fragment,a)},m(a,o){ne(e,a,o),i=!0},p(a,o){n=a;const r={};o&2&&(r.params=n[14]),!t&&o&10&&(t=!0,r.value=n[3][n[14].id],Se(()=>t=!1)),e.$set(r)},i(a){i||(A(e.$$.fragment,a),i=!0)},o(a){G(e.$$.fragment,a),i=!1},d(a){ae(e,a)}}}function kt(n){let e,t,i,l;const s=[Jn,Xn,Wn,qn,jn],a=[];function o(r,c){return r[14].field===Ee.RANGE?0:r[14].field===Ee.SEED?1:r[14].field===Ee.TEXTAREA?2:r[14].field===Ee.CHECKBOX?3:r[14].field===Ee.SELECT?4:-1}return~(e=o(n))&&(t=a[e]=s[e](n)),{c(){t&&t.c(),i=be()},l(r){t&&t.l(r),i=be()},m(r,c){~e&&a[e].m(r,c),O(r,i,c),l=!0},p(r,c){let k=e;e=o(r),e===k?~e&&a[e].p(r,c):(t&&(me(),G(a[k],1,1,()=>{a[k]=null}),pe()),~e?(t=a[e],t?t.p(r,c):(t=a[e]=s[e](r),t.c()),A(t,1),t.m(i.parentNode,i)):t=null)},i(r){l||(A(t),l=!0)},o(r){G(t),l=!1},d(r){r&&b(i),~e&&a[e].d(r)}}}function Pt(n){let e,t,i="Advanced Options",l,s,a,o,r=xe(n[2]),c=[];for(let v=0;v<r.length;v+=1)c[v]=wt(yt(n,r,v));const k=v=>G(c[v],1,1,()=>{c[v]=null});return{c(){e=L("details"),t=L("summary"),t.textContent=i,l=U(),s=L("div");for(let v=0;v<c.length;v+=1)c[v].c();this.h()},l(v){e=R(v,"DETAILS",{});var _=$(e);t=R(_,"SUMMARY",{class:!0,"data-svelte-h":!0}),fe(t)!=="svelte-uye1v8"&&(t.textContent=i),l=z(_),s=R(_,"DIV",{class:!0});var d=$(s);for(let S=0;S<c.length;S+=1)c[S].l(d);d.forEach(b),_.forEach(b),this.h()},h(){p(t,"class","cursor-pointer font-medium"),p(s,"class",a="grid grid-cols-1 items-center gap-3 "+(Object.values(n[0]).length>5?"sm:grid-cols-2":""))},m(v,_){O(v,e,_),P(e,t),P(e,l),P(e,s);for(let d=0;d<c.length;d+=1)c[d]&&c[d].m(s,null);o=!0},p(v,_){if(_&12){r=xe(v[2]);let d;for(d=0;d<r.length;d+=1){const S=yt(v,r,d);c[d]?(c[d].p(S,_),A(c[d],1)):(c[d]=wt(S),c[d].c(),A(c[d],1),c[d].m(s,null))}for(me(),d=r.length;d<c.length;d+=1)k(d);pe()}(!o||_&1&&a!==(a="grid grid-cols-1 items-center gap-3 "+(Object.values(v[0]).length>5?"sm:grid-cols-2":"")))&&p(s,"class",a)},i(v){if(!o){for(let _=0;_<r.length;_+=1)A(c[_]);o=!0}},o(v){c=c.filter(Boolean);for(let _=0;_<c.length;_+=1)G(c[_]);o=!1},d(v){v&&b(e),et(c,v)}}}function Yn(n){let e,t,i;function l(a){n[13](a,n[14])}let s={params:n[14]};return n[3][n[14].id]!==void 0&&(s.value=n[3][n[14].id]),e=new jt({props:s}),de.push(()=>ke(e,"value",l)),{c(){ee(e.$$.fragment)},l(a){te(e.$$.fragment,a)},m(a,o){ne(e,a,o),i=!0},p(a,o){n=a;const r={};o&4&&(r.params=n[14]),!t&&o&12&&(t=!0,r.value=n[3][n[14].id],Se(()=>t=!1)),e.$set(r)},i(a){i||(A(e.$$.fragment,a),i=!0)},o(a){G(e.$$.fragment,a),i=!1},d(a){ae(e,a)}}}function Qn(n){let e,t,i;function l(a){n[12](a,n[14])}let s={params:n[14]};return n[3][n[14].id]!==void 0&&(s.value=n[3][n[14].id]),e=new zt({props:s}),de.push(()=>ke(e,"value",l)),{c(){ee(e.$$.fragment)},l(a){te(e.$$.fragment,a)},m(a,o){ne(e,a,o),i=!0},p(a,o){n=a;const r={};o&4&&(r.params=n[14]),!t&&o&12&&(t=!0,r.value=n[3][n[14].id],Se(()=>t=!1)),e.$set(r)},i(a){i||(A(e.$$.fragment,a),i=!0)},o(a){G(e.$$.fragment,a),i=!1},d(a){ae(e,a)}}}function Kn(n){let e,t,i;function l(a){n[11](a,n[14])}let s={params:n[14]};return n[3][n[14].id]!==void 0&&(s.value=n[3][n[14].id]),e=new st({props:s}),de.push(()=>ke(e,"value",l)),{c(){ee(e.$$.fragment)},l(a){te(e.$$.fragment,a)},m(a,o){ne(e,a,o),i=!0},p(a,o){n=a;const r={};o&4&&(r.params=n[14]),!t&&o&12&&(t=!0,r.value=n[3][n[14].id],Se(()=>t=!1)),e.$set(r)},i(a){i||(A(e.$$.fragment,a),i=!0)},o(a){G(e.$$.fragment,a),i=!1},d(a){ae(e,a)}}}function Zn(n){let e,t,i;function l(a){n[10](a,n[14])}let s={params:n[14]};return n[3][n[14].id]!==void 0&&(s.value=n[3][n[14].id]),e=new Ut({props:s}),de.push(()=>ke(e,"value",l)),{c(){ee(e.$$.fragment)},l(a){te(e.$$.fragment,a)},m(a,o){ne(e,a,o),i=!0},p(a,o){n=a;const r={};o&4&&(r.params=n[14]),!t&&o&12&&(t=!0,r.value=n[3][n[14].id],Se(()=>t=!1)),e.$set(r)},i(a){i||(A(e.$$.fragment,a),i=!0)},o(a){G(e.$$.fragment,a),i=!1},d(a){ae(e,a)}}}function ea(n){let e,t,i;function l(a){n[9](a,n[14])}let s={params:n[14]};return n[3][n[14].id]!==void 0&&(s.value=n[3][n[14].id]),e=new lt({props:s}),de.push(()=>ke(e,"value",l)),{c(){ee(e.$$.fragment)},l(a){te(e.$$.fragment,a)},m(a,o){ne(e,a,o),i=!0},p(a,o){n=a;const r={};o&4&&(r.params=n[14]),!t&&o&12&&(t=!0,r.value=n[3][n[14].id],Se(()=>t=!1)),e.$set(r)},i(a){i||(A(e.$$.fragment,a),i=!0)},o(a){G(e.$$.fragment,a),i=!1},d(a){ae(e,a)}}}function wt(n){let e,t,i,l;const s=[ea,Zn,Kn,Qn,Yn],a=[];function o(r,c){return r[14].field===Ee.RANGE?0:r[14].field===Ee.SEED?1:r[14].field===Ee.TEXTAREA?2:r[14].field===Ee.CHECKBOX?3:r[14].field===Ee.SELECT?4:-1}return~(e=o(n))&&(t=a[e]=s[e](n)),{c(){t&&t.c(),i=be()},l(r){t&&t.l(r),i=be()},m(r,c){~e&&a[e].m(r,c),O(r,i,c),l=!0},p(r,c){let k=e;e=o(r),e===k?~e&&a[e].p(r,c):(t&&(me(),G(a[k],1,1,()=>{a[k]=null}),pe()),~e?(t=a[e],t?t.p(r,c):(t=a[e]=s[e](r),t.c()),A(t,1),t.m(i.parentNode,i)):t=null)},i(r){l||(A(t),l=!0)},o(r){G(t),l=!1},d(r){r&&b(i),~e&&a[e].d(r)}}}function ta(n){let e,t,i,l,s=n[1]&&St(n),a=n[2]&&n[2].length>0&&Pt(n);return{c(){e=L("div"),t=L("div"),s&&s.c(),i=U(),a&&a.c(),this.h()},l(o){e=R(o,"DIV",{class:!0});var r=$(e);t=R(r,"DIV",{class:!0});var c=$(t);s&&s.l(c),c.forEach(b),i=z(r),a&&a.l(r),r.forEach(b),this.h()},h(){p(t,"class","grid grid-cols-1 items-center gap-3"),p(e,"class","flex flex-col gap-3")},m(o,r){O(o,e,r),P(e,t),s&&s.m(t,null),P(e,i),a&&a.m(e,null),l=!0},p(o,[r]){o[1]?s?(s.p(o,r),r&2&&A(s,1)):(s=St(o),s.c(),A(s,1),s.m(t,null)):s&&(me(),G(s,1,1,()=>{s=null}),pe()),o[2]&&o[2].length>0?a?(a.p(o,r),r&4&&A(a,1)):(a=Pt(o),a.c(),A(a,1),a.m(e,null)):a&&(me(),G(a,1,1,()=>{a=null}),pe())},i(o){l||(A(s),A(a),l=!0)},o(o){G(s),G(a),l=!1},d(o){o&&b(e),s&&s.d(),a&&a.d()}}}function na(n,e,t){let i,l,s;Ie(n,ce,w=>t(3,s=w));let{pipelineParams:a}=e;function o(w,C){n.$$.not_equal(s[C.id],w)&&(s[C.id]=w,ce.set(s))}function r(w,C){n.$$.not_equal(s[C.id],w)&&(s[C.id]=w,ce.set(s))}function c(w,C){n.$$.not_equal(s[C.id],w)&&(s[C.id]=w,ce.set(s))}function k(w,C){n.$$.not_equal(s[C.id],w)&&(s[C.id]=w,ce.set(s))}function v(w,C){n.$$.not_equal(s[C.id],w)&&(s[C.id]=w,ce.set(s))}function _(w,C){n.$$.not_equal(s[C.id],w)&&(s[C.id]=w,ce.set(s))}function d(w,C){n.$$.not_equal(s[C.id],w)&&(s[C.id]=w,ce.set(s))}function S(w,C){n.$$.not_equal(s[C.id],w)&&(s[C.id]=w,ce.set(s))}function E(w,C){n.$$.not_equal(s[C.id],w)&&(s[C.id]=w,ce.set(s))}function T(w,C){n.$$.not_equal(s[C.id],w)&&(s[C.id]=w,ce.set(s))}return n.$$set=w=>{"pipelineParams"in w&&t(0,a=w.pipelineParams)},n.$$.update=()=>{var w,C;n.$$.dirty&1&&t(2,i=(w=Object.values(a))==null?void 0:w.filter(x=>(x==null?void 0:x.hide)==!0&&(x==null?void 0:x.disabled)!==!0)),n.$$.dirty&1&&t(1,l=(C=Object.values(a))==null?void 0:C.filter(x=>(x==null?void 0:x.hide)!==!0))},[a,l,i,s,o,r,c,k,v,_,d,S,E,T]}class aa extends ge{constructor(e){super(),_e(this,e,na,ta,he,{pipelineParams:0})}}function ia(n){let e,t;return{c(){e=Ue("svg"),t=Ue("path"),this.h()},l(i){e=ze(i,"svg",{xmlns:!0,height:!0,viewBox:!0,class:!0});var l=$(e);t=ze(l,"path",{fill:!0,d:!0}),$(t).forEach(b),l.forEach(b),this.h()},h(){p(t,"fill","currentColor"),p(t,"d","M304 48a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zm0 416a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zM48 304a48 48 0 1 0 0-96 48 48 0 1 0 0 96zm464-48a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zM142.9 437A48 48 0 1 0 75 369.1 48 48 0 1 0 142.9 437zm0-294.2A48 48 0 1 0 75 75a48 48 0 1 0 67.9 67.9zM369.1 437A48 48 0 1 0 437 369.1 48 48 0 1 0 369.1 437z"),p(e,"xmlns","http://www.w3.org/2000/svg"),p(e,"height","1em"),p(e,"viewBox","0 0 512 512"),p(e,"class",n[0])},m(i,l){O(i,e,l),P(e,t)},p(i,[l]){l&1&&p(e,"class",i[0])},i:le,o:le,d(i){i&&b(e)}}}function ra(n,e,t){let{classList:i}=e;return n.$$set=l=>{"classList"in l&&t(0,i=l.classList)},[i]}class la extends ge{constructor(e){super(),_e(this,e,ra,ia,he,{classList:0})}}function Ct(n){let e,t,i,l,s,a,o;return{c(){e=L("div"),t=L("div"),i=se(n[0]),l=U(),s=L("div"),this.h()},l(r){e=R(r,"DIV",{class:!0});var c=$(e);t=R(c,"DIV",{class:!0});var k=$(t);i=oe(k,n[0]),k.forEach(b),l=z(c),s=R(c,"DIV",{class:!0,style:!0}),$(s).forEach(b),c.forEach(b),this.h()},h(){p(t,"class","rounded bg-red-800 p-4 text-white"),p(s,"class","bar transition-all duration-500"),we(s,"width","0"),p(e,"class","fixed right-0 top-0 m-4 cursor-pointer")},m(r,c){O(r,e,c),P(e,t),P(t,i),P(e,l),P(e,s),a||(o=ue(e,"click",n[2]),a=!0)},p(r,c){c&1&&Le(i,r[0])},d(r){r&&b(e),a=!1,o()}}}function sa(n){let e,t=n[0]&&Ct(n);return{c(){t&&t.c(),e=be()},l(i){t&&t.l(i),e=be()},m(i,l){t&&t.m(i,l),O(i,e,l)},p(i,[l]){i[0]?t?t.p(i,l):(t=Ct(i),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:le,o:le,d(i){i&&b(e),t&&t.d(i)}}}function oa(n,e,t){let{message:i=""}=e,l=0;const s=()=>t(0,i="");return n.$$set=a=>{"message"in a&&t(0,i=a.message)},n.$$.update=()=>{n.$$.dirty&3&&i!==""&&(console.log("message",i),clearTimeout(l),t(1,l=setTimeout(()=>{t(0,i="")},5e3)))},[i,l,s]}class ca extends ge{constructor(e){super(),_e(this,e,oa,sa,he,{message:0})}}const{document:Et}=ln;function nt(n){const e=n.slice(),t=Object.fromEntries(Object.entries(e[0]).filter(([i,l])=>i!=="prompt"&&i!=="ip_adapter_scale"));return e[34]=t,e}function It(n){let e,t;return{c(){e=new nn(!1),t=be(),this.h()},l(i){e=an(i,!1),t=be(),this.h()},h(){e.a=t},m(i,l){e.m(n[1],i,l),O(i,t,l)},p(i,l){l[0]&2&&e.p(i[1])},d(i){i&&(b(t),e.d())}}}function Lt(n){let e,t,i,l,s,a,o,r,c="Duplicate",k;return{c(){e=L("p"),t=se("There are "),i=L("span"),l=se(n[4]),s=se(`
        user(s) sharing the same GPU, affecting real-time performance. Maximum queue size is `),a=se(n[3]),o=se(`.
        `),r=L("a"),r.textContent=c,k=se(" and run it on your own GPU."),this.h()},l(v){e=R(v,"P",{class:!0});var _=$(e);t=oe(_,"There are "),i=R(_,"SPAN",{id:!0,class:!0});var d=$(i);l=oe(d,n[4]),d.forEach(b),s=oe(_,`
        user(s) sharing the same GPU, affecting real-time performance. Maximum queue size is `),a=oe(_,n[3]),o=oe(_,`.
        `),r=R(_,"A",{href:!0,target:!0,class:!0,"data-svelte-h":!0}),fe(r)!=="svelte-10aq8mu"&&(r.textContent=c),k=oe(_," and run it on your own GPU."),_.forEach(b),this.h()},h(){p(i,"id","queue_size"),p(i,"class","font-bold"),p(r,"href","https://huggingface.co/spaces/radames/Real-Time-Latent-Consistency-Model?duplicate=true"),p(r,"target","_blank"),p(r,"class","text-blue-500 underline hover:no-underline"),p(e,"class","text-sm")},m(v,_){O(v,e,_),P(e,t),P(e,i),P(i,l),P(e,s),P(e,a),P(e,o),P(e,r),P(e,k)},p(v,_){_[0]&16&&Le(l,v[4]),_[0]&8&&Le(a,v[3])},d(v){v&&b(e)}}}function ua(n){let e,t,i,l,s="Loading...",a;return t=new la({props:{classList:"animate-spin opacity-50"}}),{c(){e=L("div"),ee(t.$$.fragment),i=U(),l=L("p"),l.textContent=s,this.h()},l(o){e=R(o,"DIV",{class:!0});var r=$(e);te(t.$$.fragment,r),i=z(r),l=R(r,"P",{"data-svelte-h":!0}),fe(l)!=="svelte-qdsr2u"&&(l.textContent=s),r.forEach(b),this.h()},h(){p(e,"class","flex items-center justify-center gap-3 py-48 text-2xl")},m(o,r){O(o,e,r),ne(t,e,null),P(e,i),P(e,l),a=!0},p:le,i(o){a||(A(t.$$.fragment,o),a=!0)},o(o){G(t.$$.fragment,o),a=!1},d(o){o&&b(e),ae(t)}}}function fa(n){let e,t,i,l,s,a,o,r,c,k,v,_,d,S,E,T="🎨 IP-Adapter Reference Image",w,C,x,I,u,f,m,g,y,h,D,N,B=`This Final Project is completed and authored by
          <span class="ml-2 font-bold bg-gradient-to-r from-pink-500 via-purple-500 to-blue-500 text-transparent bg-clip-text">Ziqian Liu</span>
          and
          <span class="font-bold bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 text-transparent bg-clip-text">Hongsheng Ye</span>`,M,q,W,Z=n[2]&&Rt(n);l=new kn({}),r=new Ge({props:{disabled:n[8],classList:"text-lg my-1 p-2",$$slots:{default:[pa]},$$scope:{ctx:n}}}),r.$on("click",n[13]),k=new Ge({props:{classList:"text-lg my-1 p-2 bg-green-600 hover:bg-green-700",$$slots:{default:[ha]},$$scope:{ctx:n}}}),k.$on("click",n[14]);let re=n[9]&&Dt(),J=n[0].prompt&&At(n);f=new Ge({props:{classList:"text-sm px-4 py-2 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white rounded-lg shadow-md transition-all duration-200 font-medium",$$slots:{default:[ga]},$$scope:{ctx:n}}}),f.$on("click",n[22]);let Q=n[7]&&Tt(n);function F(V,H){return V[6]?ba:ya}let X=F(n),Y=X(n),j=n[0].ip_adapter_scale&&xt(n),K=n[0]&&Ft(nt(n));return{c(){e=L("article"),Z&&Z.c(),t=U(),i=L("div"),ee(l.$$.fragment),a=U(),o=L("div"),ee(r.$$.fragment),c=U(),ee(k.$$.fragment),v=U(),re&&re.c(),_=U(),J&&J.c(),d=U(),S=L("div"),E=L("label"),E.textContent=T,w=U(),C=L("div"),x=L("div"),I=L("input"),u=U(),ee(f.$$.fragment),m=U(),Q&&Q.c(),g=U(),Y.c(),y=U(),j&&j.c(),h=U(),K&&K.c(),D=U(),N=L("h1"),N.innerHTML=B,this.h()},l(V){e=R(V,"ARTICLE",{class:!0});var H=$(e);Z&&Z.l(H),t=z(H),i=R(H,"DIV",{class:!0});var ve=$(i);te(l.$$.fragment,ve),ve.forEach(b),a=z(H),o=R(H,"DIV",{class:!0});var ie=$(o);te(r.$$.fragment,ie),c=z(ie),te(k.$$.fragment,ie),v=z(ie),re&&re.l(ie),_=z(ie),J&&J.l(ie),d=z(ie),S=R(ie,"DIV",{class:!0});var Re=$(S);E=R(Re,"LABEL",{class:!0,style:!0,"data-svelte-h":!0}),fe(E)!=="svelte-1xubeow"&&(E.textContent=T),w=z(Re),C=R(Re,"DIV",{class:!0});var Ce=$(C);x=R(Ce,"DIV",{class:!0});var De=$(x);I=R(De,"INPUT",{id:!0,type:!0,accept:!0,class:!0}),u=z(De),te(f.$$.fragment,De),m=z(De),Q&&Q.l(De),De.forEach(b),g=z(Ce),Y.l(Ce),y=z(Ce),j&&j.l(Ce),Ce.forEach(b),Re.forEach(b),h=z(ie),K&&K.l(ie),D=z(ie),N=R(ie,"H1",{class:!0,"data-svelte-h":!0}),fe(N)!=="svelte-1twh80h"&&(N.innerHTML=B),ie.forEach(b),H.forEach(b),this.h()},h(){p(i,"class",s=n[2]?"sm:col-start-2":"col-span-2"),p(E,"class","block text-lg font-bold mb-3 text-gray-800 dark:text-gray-200"),we(E,"font-family","'Inter', 'SF Pro Display', -apple-system, sans-serif"),we(E,"letter-spacing","-0.01em"),p(I,"id","ip-ref-image-input"),p(I,"type","file"),p(I,"accept","image/*"),p(I,"class","hidden"),p(x,"class","flex items-center gap-2 flex-wrap"),p(C,"class","flex flex-col gap-3"),p(S,"class","my-4 p-5 border-2 border-blue-300 dark:border-blue-700 rounded-xl bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 dark:from-gray-800 dark:via-gray-850 dark:to-gray-900 shadow-xl"),p(N,"class","text-center mt-12 text-lg font-semibold text-black dark:text-white"),p(o,"class","sm:col-span-2"),p(e,"class","my-3 grid grid-cols-1 gap-3 sm:grid-cols-2")},m(V,H){O(V,e,H),Z&&Z.m(e,null),P(e,t),P(e,i),ne(l,i,null),P(e,a),P(e,o),ne(r,o,null),P(o,c),ne(k,o,null),P(o,v),re&&re.m(o,null),P(o,_),J&&J.m(o,null),P(o,d),P(o,S),P(S,E),P(S,w),P(S,C),P(C,x),P(x,I),P(x,u),ne(f,x,null),P(x,m),Q&&Q.m(x,null),P(C,g),Y.m(C,null),P(C,y),j&&j.m(C,null),P(o,h),K&&K.m(o,null),P(o,D),P(o,N),M=!0,q||(W=ue(I,"change",n[15]),q=!0)},p(V,H){V[2]?Z?(Z.p(V,H),H[0]&4&&A(Z,1)):(Z=Rt(V),Z.c(),A(Z,1),Z.m(e,t)):Z&&(me(),G(Z,1,1,()=>{Z=null}),pe()),(!M||H[0]&4&&s!==(s=V[2]?"sm:col-start-2":"col-span-2"))&&p(i,"class",s);const ve={};H[0]&256&&(ve.disabled=V[8]),H[0]&1024|H[1]&16&&(ve.$$scope={dirty:H,ctx:V}),r.$set(ve);const ie={};H[0]&512|H[1]&16&&(ie.$$scope={dirty:H,ctx:V}),k.$set(ie),V[9]?re||(re=Dt(),re.c(),re.m(o,_)):re&&(re.d(1),re=null),V[0].prompt?J?(J.p(V,H),H[0]&1&&A(J,1)):(J=At(V),J.c(),A(J,1),J.m(o,d)):J&&(me(),G(J,1,1,()=>{J=null}),pe());const Re={};H[1]&16&&(Re.$$scope={dirty:H,ctx:V}),f.$set(Re),V[7]?Q?(Q.p(V,H),H[0]&128&&A(Q,1)):(Q=Tt(V),Q.c(),A(Q,1),Q.m(x,null)):Q&&(me(),G(Q,1,1,()=>{Q=null}),pe()),X===(X=F(V))&&Y?Y.p(V,H):(Y.d(1),Y=X(V),Y&&(Y.c(),Y.m(C,y))),V[0].ip_adapter_scale?j?(j.p(V,H),H[0]&1&&A(j,1)):(j=xt(V),j.c(),A(j,1),j.m(C,null)):j&&(me(),G(j,1,1,()=>{j=null}),pe()),V[0]?K?(K.p(nt(V),H),H[0]&1&&A(K,1)):(K=Ft(nt(V)),K.c(),A(K,1),K.m(o,D)):K&&(me(),G(K,1,1,()=>{K=null}),pe())},i(V){M||(A(Z),A(l.$$.fragment,V),A(r.$$.fragment,V),A(k.$$.fragment,V),A(J),A(f.$$.fragment,V),A(Q),A(j),A(K),M=!0)},o(V){G(Z),G(l.$$.fragment,V),G(r.$$.fragment,V),G(k.$$.fragment,V),G(J),G(f.$$.fragment,V),G(Q),G(j),G(K),M=!1},d(V){V&&b(e),Z&&Z.d(),ae(l),ae(r),ae(k),re&&re.d(),J&&J.d(),ae(f),Q&&Q.d(),Y.d(),j&&j.d(),K&&K.d(),q=!1,W()}}}function Rt(n){let e,t,i,l,s,a="Generation Mode:",o,r,c,k="Full Image",v,_="Human Only",d,S,E;return t=new xn({props:{width:Number(n[0].width.default),height:Number(n[0].height.default)}}),{c(){e=L("div"),ee(t.$$.fragment),i=U(),l=L("div"),s=L("label"),s.textContent=a,o=U(),r=L("select"),c=L("option"),c.textContent=k,v=L("option"),v.textContent=_,this.h()},l(T){e=R(T,"DIV",{class:!0});var w=$(e);te(t.$$.fragment,w),i=z(w),l=R(w,"DIV",{});var C=$(l);s=R(C,"LABEL",{for:!0,class:!0,style:!0,"data-svelte-h":!0}),fe(s)!=="svelte-in6z76"&&(s.textContent=a),o=z(C),r=R(C,"SELECT",{id:!0,class:!0});var x=$(r);c=R(x,"OPTION",{"data-svelte-h":!0}),fe(c)!=="svelte-1g2jnjh"&&(c.textContent=k),v=R(x,"OPTION",{"data-svelte-h":!0}),fe(v)!=="svelte-1yrdxno"&&(v.textContent=_),x.forEach(b),C.forEach(b),w.forEach(b),this.h()},h(){p(s,"for","mode"),p(s,"class","block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2"),we(s,"font-family","'Inter', 'SF Pro Display', -apple-system, sans-serif"),c.__value="full",ye(c,c.__value),v.__value="human",ye(v,v.__value),p(r,"id","mode"),p(r,"class","w-full border-2 border-gray-300 dark:border-gray-600 rounded-lg px-4 py-2.5 dark:text-black bg-white dark:bg-gray-100 shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all font-medium"),p(e,"class","sm:col-start-1 flex flex-col gap-3")},m(T,w){O(T,e,w),ne(t,e,null),P(e,i),P(e,l),P(l,s),P(l,o),P(l,r),P(r,c),P(r,v),d=!0,S||(E=ue(r,"change",n[20]),S=!0)},p(T,w){const C={};w[0]&1&&(C.width=Number(T[0].width.default)),w[0]&1&&(C.height=Number(T[0].height.default)),t.$set(C)},i(T){d||(A(t.$$.fragment,T),d=!0)},o(T){G(t.$$.fragment,T),d=!1},d(T){T&&b(e),ae(t),S=!1,E()}}}function da(n){let e;return{c(){e=se("Start")},l(t){e=oe(t,"Start")},m(t,i){O(t,e,i)},d(t){t&&b(e)}}}function ma(n){let e;return{c(){e=se("Stop")},l(t){e=oe(t,"Stop")},m(t,i){O(t,e,i)},d(t){t&&b(e)}}}function pa(n){let e;function t(s,a){return s[10]?ma:da}let i=t(n),l=i(n);return{c(){l.c(),e=be()},l(s){l.l(s),e=be()},m(s,a){l.m(s,a),O(s,e,a)},p(s,a){i!==(i=t(s))&&(l.d(1),l=i(s),l&&(l.c(),l.m(e.parentNode,e)))},d(s){s&&b(e),l.d(s)}}}function ha(n){let e=n[9]?"🛑 Stop Recording":"🎤 Voice Input",t;return{c(){t=se(e)},l(i){t=oe(i,e)},m(i,l){O(i,t,l)},p(i,l){l[0]&512&&e!==(e=i[9]?"🛑 Stop Recording":"🎤 Voice Input")&&Le(t,e)},d(i){i&&b(t)}}}function Dt(n){let e,t='<div class="w-3 h-3 bg-red-500 rounded-full animate-ping"></div> <p class="text-sm font-medium">Recording... speak now 🎙️</p>';return{c(){e=L("div"),e.innerHTML=t,this.h()},l(i){e=R(i,"DIV",{class:!0,"data-svelte-h":!0}),fe(e)!=="svelte-1vxrjpl"&&(e.innerHTML=t),this.h()},h(){p(e,"class","flex items-center gap-2 mt-1 text-red-500 animate-pulse")},m(i,l){O(i,e,l)},d(i){i&&b(e)}}}function At(n){let e,t,i,l;function s(o){n[21](o)}let a={params:n[0].prompt};return n[11].prompt!==void 0&&(a.value=n[11].prompt),t=new st({props:a}),de.push(()=>ke(t,"value",s)),{c(){e=L("div"),ee(t.$$.fragment),this.h()},l(o){e=R(o,"DIV",{class:!0});var r=$(e);te(t.$$.fragment,r),r.forEach(b),this.h()},h(){p(e,"class","my-4")},m(o,r){O(o,e,r),ne(t,e,null),l=!0},p(o,r){const c={};r[0]&1&&(c.params=o[0].prompt),!i&&r[0]&2048&&(i=!0,c.value=o[11].prompt,Se(()=>i=!1)),t.$set(c)},i(o){l||(A(t.$$.fragment,o),l=!0)},o(o){G(t.$$.fragment,o),l=!1},d(o){o&&b(e),ae(t)}}}function ga(n){let e;return{c(){e=se("📷 Select Image")},l(t){e=oe(t,"📷 Select Image")},m(t,i){O(t,e,i)},d(t){t&&b(e)}}}function Tt(n){let e,t,i,l;return e=new Ge({props:{classList:"text-sm px-4 py-2 bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white rounded-lg shadow-md transition-all duration-200 font-medium",$$slots:{default:[_a]},$$scope:{ctx:n}}}),e.$on("click",n[16]),i=new Ge({props:{classList:"text-sm px-4 py-2 bg-gradient-to-r from-gray-600 to-gray-700 hover:from-gray-700 hover:to-gray-800 text-white rounded-lg shadow-md transition-all duration-200 font-medium",$$slots:{default:[va]},$$scope:{ctx:n}}}),i.$on("click",n[17]),{c(){ee(e.$$.fragment),t=U(),ee(i.$$.fragment)},l(s){te(e.$$.fragment,s),t=z(s),te(i.$$.fragment,s)},m(s,a){ne(e,s,a),O(s,t,a),ne(i,s,a),l=!0},p(s,a){const o={};a[1]&16&&(o.$$scope={dirty:a,ctx:s}),e.$set(o);const r={};a[1]&16&&(r.$$scope={dirty:a,ctx:s}),i.$set(r)},i(s){l||(A(e.$$.fragment,s),A(i.$$.fragment,s),l=!0)},o(s){G(e.$$.fragment,s),G(i.$$.fragment,s),l=!1},d(s){s&&b(t),ae(e,s),ae(i,s)}}}function _a(n){let e;return{c(){e=se("⬆️ Upload")},l(t){e=oe(t,"⬆️ Upload")},m(t,i){O(t,e,i)},d(t){t&&b(e)}}}function va(n){let e;return{c(){e=se("✕ Clear")},l(t){e=oe(t,"✕ Clear")},m(t,i){O(t,e,i)},d(t){t&&b(e)}}}function ya(n){let e,t='<p class="text-sm text-gray-500 dark:text-gray-400">No reference image selected</p>';return{c(){e=L("div"),e.innerHTML=t,this.h()},l(i){e=R(i,"DIV",{class:!0,"data-svelte-h":!0}),fe(e)!=="svelte-3wkhkx"&&(e.innerHTML=t),this.h()},h(){p(e,"class","mt-2 p-4 bg-gray-100 dark:bg-gray-700 rounded-lg border-2 border-dashed border-gray-300 dark:border-gray-600 text-center")},m(i,l){O(i,e,l)},p:le,d(i){i&&b(e)}}}function ba(n){let e,t,i="📸 Preview:",l,s,a,o;return{c(){e=L("div"),t=L("p"),t.textContent=i,l=U(),s=L("div"),a=L("img"),this.h()},l(r){e=R(r,"DIV",{class:!0});var c=$(e);t=R(c,"P",{class:!0,"data-svelte-h":!0}),fe(t)!=="svelte-168em8s"&&(t.textContent=i),l=z(c),s=R(c,"DIV",{class:!0});var k=$(s);a=R(k,"IMG",{src:!0,alt:!0,class:!0}),k.forEach(b),c.forEach(b),this.h()},h(){p(t,"class","text-xs font-medium text-gray-700 dark:text-gray-300 mb-2"),He(a.src,o=n[6])||p(a,"src",o),p(a,"alt","IP-Adapter Reference"),p(a,"class","max-w-full max-h-64 rounded-lg border-2 border-gray-300 dark:border-gray-600 object-contain shadow-md"),p(s,"class","flex justify-center"),p(e,"class","mt-3 p-3 bg-white dark:bg-gray-700 rounded-lg border-2 border-blue-300 dark:border-blue-600 shadow-inner")},m(r,c){O(r,e,c),P(e,t),P(e,l),P(e,s),P(s,a)},p(r,c){c[0]&64&&!He(a.src,o=r[6])&&p(a,"src",o)},d(r){r&&b(e)}}}function xt(n){let e,t,i,l;function s(o){n[23](o)}let a={params:n[0].ip_adapter_scale};return n[11].ip_adapter_scale!==void 0&&(a.value=n[11].ip_adapter_scale),t=new lt({props:a}),de.push(()=>ke(t,"value",s)),{c(){e=L("div"),ee(t.$$.fragment),this.h()},l(o){e=R(o,"DIV",{class:!0});var r=$(e);te(t.$$.fragment,r),r.forEach(b),this.h()},h(){p(e,"class","mt-3 pt-3 border-t-2 border-blue-200 dark:border-blue-600")},m(o,r){O(o,e,r),ne(t,e,null),l=!0},p(o,r){const c={};r[0]&1&&(c.params=o[0].ip_adapter_scale),!i&&r[0]&2048&&(i=!0,c.value=o[11].ip_adapter_scale,Se(()=>i=!1)),t.$set(c)},i(o){l||(A(t.$$.fragment,o),l=!0)},o(o){G(t.$$.fragment,o),l=!1},d(o){o&&b(e),ae(t)}}}function Ft(n){let e=Object.keys(n[34]).length>0,t,i,l=e&&$t(n);return{c(){l&&l.c(),t=be()},l(s){l&&l.l(s),t=be()},m(s,a){l&&l.m(s,a),O(s,t,a),i=!0},p(s,a){a[0]&1&&(e=Object.keys(s[34]).length>0),e?l?(l.p(s,a),a[0]&1&&A(l,1)):(l=$t(s),l.c(),A(l,1),l.m(t.parentNode,t)):l&&(me(),G(l,1,1,()=>{l=null}),pe())},i(s){i||(A(l),i=!0)},o(s){G(l),i=!1},d(s){s&&b(t),l&&l.d(s)}}}function $t(n){let e,t;return e=new aa({props:{pipelineParams:n[34]}}),{c(){ee(e.$$.fragment)},l(i){te(e.$$.fragment,i)},m(i,l){ne(e,i,l),t=!0},p(i,l){const s={};l[0]&1&&(s.pipelineParams=i[34]),e.$set(s)},i(i){t||(A(e.$$.fragment,i),t=!0)},o(i){G(e.$$.fragment,i),t=!1},d(i){ae(e,i)}}}function Sa(n){let e,t="",i,l,s,a,o,r,c,k,v,_,d,S;function E(f){n[19](f)}let T={};n[5]!==void 0&&(T.message=n[5]),a=new ca({props:T}),de.push(()=>ke(a,"message",E));let w=n[1]&&It(n),C=n[3]>0&&Lt(n);const x=[fa,ua],I=[];function u(f,m){return f[0]?0:1}return _=u(n),d=I[_]=x[_](n),{c(){e=L("script"),e.innerHTML=t,l=U(),s=L("main"),ee(a.$$.fragment),r=U(),c=L("article"),w&&w.c(),k=U(),C&&C.c(),v=U(),d.c(),this.h()},l(f){const m=tn("svelte-c3fyjj",Et.head);e=R(m,"SCRIPT",{src:!0,"data-svelte-h":!0}),fe(e)!=="svelte-1oi43ze"&&(e.innerHTML=t),m.forEach(b),l=z(f),s=R(f,"MAIN",{class:!0});var g=$(s);te(a.$$.fragment,g),r=z(g),c=R(g,"ARTICLE",{class:!0});var y=$(c);w&&w.l(y),k=z(y),C&&C.l(y),y.forEach(b),v=z(g),d.l(g),g.forEach(b),this.h()},h(){He(e.src,i="https://cdnjs.cloudflare.com/ajax/libs/iframe-resizer/4.3.9/iframeResizer.contentWindow.min.js")||p(e,"src",i),p(c,"class","text-center"),p(s,"class","container mx-auto flex max-w-5xl flex-col gap-3 px-4 py-4")},m(f,m){P(Et.head,e),O(f,l,m),O(f,s,m),ne(a,s,null),P(s,r),P(s,c),w&&w.m(c,null),P(c,k),C&&C.m(c,null),P(s,v),I[_].m(s,null),S=!0},p(f,m){const g={};!o&&m[0]&32&&(o=!0,g.message=f[5],Se(()=>o=!1)),a.$set(g),f[1]?w?w.p(f,m):(w=It(f),w.c(),w.m(c,k)):w&&(w.d(1),w=null),f[3]>0?C?C.p(f,m):(C=Lt(f),C.c(),C.m(c,null)):C&&(C.d(1),C=null);let y=_;_=u(f),_===y?I[_].p(f,m):(me(),G(I[y],1,1,()=>{I[y]=null}),pe(),d=I[_],d?d.p(f,m):(d=I[_]=x[_](f),d.c()),A(d,1),d.m(s,null))},i(f){S||(A(a.$$.fragment,f),A(d),S=!0)},o(f){G(a.$$.fragment,f),G(d),S=!1},d(f){f&&(b(l),b(s)),b(e),ae(a),w&&w.d(),C&&C.d(),I[_].d()}}}function ka(n,e,t){let i,l,s,a,o;Ie(n,Ae,F=>t(18,l=F)),Ie(n,cn,F=>t(28,s=F)),Ie(n,Ht,F=>t(29,a=F)),Ie(n,ce,F=>t(11,o=F));let r,c,k,v=!1,_=0,d=0,S=!1,E="",T=null,w=null;Fe(()=>{C()});async function C(){const F=await fetch("/api/settings").then(X=>X.json());t(0,r=F.input_params.properties),c=F.info.properties,t(2,v=c.input_mode.default===Bt.IMAGE),t(3,_=F.max_queue_size),t(1,k=F.page_content),console.log(r),I(!0)}function x(F){ce.update(Y=>({...Y,mode:F})),console.log("🧩 Mode switched to:",F);const X=window.globalWs;X&&X.readyState===WebSocket.OPEN?(X.send(JSON.stringify({mode:F})),console.log(`🌐 Sent mode change to backend: ${F}`)):console.warn("⚠️ Not connected yet — click Start first!")}function I(F){S=F&&_>0,F&&u()}async function u(){if(!S)return;const F=await fetch("/api/queue").then(X=>X.json());t(4,d=F.queue_size),setTimeout(u,1e4)}function f(){return v?[Ve(),a==null?void 0:a.blob]:[s]}let m=!1;async function g(){try{if(i)v&&Ye.stop(),tt.stop(),I(!0);else{v&&(await Ye.enumerateDevices(),await Ye.start()),t(8,m=!0),await tt.start(f),t(8,m=!1),I(!1);const F=Ve(),X=(F==null?void 0:F.mode)??"full";tt.send({mode:X}),console.log("🚀 Sent initial mode after connect:",X)}}catch(F){t(5,E=F instanceof Error?F.message:""),t(8,m=!1),I(!0)}}let y=!1,h,D=[];async function N(){if(y)h.stop(),t(9,y=!1),console.log("🛑 Recording stopped");else{const F=await navigator.mediaDevices.getUserMedia({audio:!0});h=new MediaRecorder(F),D=[],h.ondataavailable=X=>D.push(X.data),h.onstop=async()=>{var j;const X=new Blob(D,{type:"audio/wav"}),Y=new FormData;Y.append("file",X,"speech.wav");try{const H=((j=(await(await fetch("/api/stt",{method:"POST",body:Y})).json()).text)==null?void 0:j.trim())||"";console.log("🎙️ Recognized:",H),ce.update(ie=>({...ie,prompt:H})),console.log("✅ Prompt store updated");const ve=document.querySelector('textarea[placeholder*="prompt"]');ve&&(ve.classList.add("border-green-500"),setTimeout(()=>ve.classList.remove("border-green-500"),800))}catch(K){console.error("Speech2Text error:",K)}},h.start(),t(9,y=!0),console.log("🎤 Recording...")}}function B(F){var j;const Y=(j=F.target.files)==null?void 0:j[0];if(Y&&Y.type.startsWith("image/")){t(7,w=Y);const K=new FileReader;K.onload=V=>{var H;t(6,T=(H=V.target)==null?void 0:H.result)},K.readAsDataURL(Y)}}async function M(){if(!w){t(5,E="Please select an image first");return}try{const F=new FormData;F.append("file",w);const Y=await(await fetch("/api/ip_ref_image",{method:"POST",body:F})).json();if(Y.status==="success"||Y.status==="warning"){t(5,E=""),console.log("✅ IP-Adapter reference image uploaded successfully"),console.log("Response:",Y);const j=document.createElement("div");j.className="fixed top-4 right-4 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg z-50 font-medium",j.textContent=Y.status==="success"?"✅ Reference image uploaded successfully!":"⚠️ Image uploaded but may not be active",document.body.appendChild(j),setTimeout(()=>j.remove(),3e3)}else t(5,E=Y.message||"Failed to upload image")}catch(F){t(5,E=F instanceof Error?F.message:"Failed to upload image"),console.error("IP-Adapter image upload error:",F)}}async function q(){t(7,w=null),t(6,T=null);const F=document.getElementById("ip-ref-image-input");F&&(F.value="");try{if((await(await fetch("/api/ip_ref_image/clear",{method:"POST"})).json()).status==="success"){console.log("✅ IP-Adapter reference image cleared");const j=document.createElement("div");j.className="fixed top-4 right-4 bg-blue-500 text-white px-4 py-2 rounded-lg shadow-lg z-50 font-medium",j.textContent="✅ Reference image cleared - IP-Adapter disabled",document.body.appendChild(j),setTimeout(()=>j.remove(),3e3)}}catch(X){console.error("Error clearing IP ref image:",X)}}function W(F){E=F,t(5,E),t(18,l)}const Z=F=>x(F.target.value);function re(F){n.$$.not_equal(o.prompt,F)&&(o.prompt=F,ce.set(o))}const J=()=>{var F;return(F=document.getElementById("ip-ref-image-input"))==null?void 0:F.click()};function Q(F){n.$$.not_equal(o.ip_adapter_scale,F)&&(o.ip_adapter_scale=F,ce.set(o))}return n.$$.update=()=>{n.$$.dirty[0]&262144&&t(10,i=l!==Ze.DISCONNECTED),n.$$.dirty[0]&262144&&l===Ze.TIMEOUT&&t(5,E="Session timed out. Please try again.")},[r,k,v,_,d,E,T,w,m,y,i,o,x,g,N,B,M,q,l,W,Z,re,J,Q]}class Ia extends ge{constructor(e){super(),_e(this,e,ka,Sa,he,{},null,[-1,-1])}}export{Ia as component,Ea as universal};
